# Smart-Home/IoT relevant rules (filtered)
# Input: PublicRules/et_rules

# source: PublicRules/et_rules/emerging-dos.rules
alert udp any any -> $HOME_NET 1900 (msg:"ET DOS Possible SSDP Amplification Scan in Progress"; content:"M-SEARCH * HTTP/1.1"; content:"ST|3a 20|ssdp|3a|all|0d 0a|"; nocase; distance:0; fast_pattern; threshold: type both,track by_src,count 2,seconds 60; reference:url,community.rapid7.com/community/metasploit/blog/2014/08/29/weekly-metasploit-update; classtype:attempted-dos; sid:2019102; rev:1; metadata:created_at 2014_09_03, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-dos.rules
alert http $EXTERNAL_NET any -> any any (msg:"ET DOS CallStranger - Attempted UPnP Reflected Amplified TCP with Multiple Callbacks (CVE-2020-12695)"; flow:established,to_server; http.method; content:"SUBSCRIBE"; http.header; content:"CALLBACK|3a 20|"; fast_pattern; nocase; content:"<http"; distance:0; content:"><http"; distance:0; pcre:"/^Callback\x3a\x20<http[^>]+><http/mi"; reference:url,github.com/yunuscadirci/CallStranger; reference:cve,2020-12695; classtype:attempted-dos; sid:2030339; rev:2; metadata:affected_product UPnP, attack_target IoT, created_at 2020_06_15, cve CVE_2020_12695, deployment Perimeter, performance_impact Low, confidence Medium, signature_severity Major, updated_at 2020_12_11;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert tcp any any -> $HOME_NET 23 (msg:"ET EXPLOIT Cisco Catalyst Remote Code Execution (CVE-2017-3881)"; flow:to_server,established; content:"|ff fa 24 00 03|CISCO_KITS"; content:"|3a|"; distance:2; within:1; isdataat:160,relative; content:!"|3a|"; within:160; reference:url,artkond.com/2017/04/10/cisco-catalyst-remote-code-execution/; classtype:attempted-user; sid:2024194; rev:1; metadata:affected_product CISCO_Catalyst, attack_target IoT, created_at 2017_04_10, cve CVE_2017_3881, deployment Datacenter, performance_impact Low, confidence Medium, signature_severity Critical, tag CISA_KEV, updated_at 2019_07_26, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert tcp any any -> $HOME_NET [23,2323] (msg:"ET EXPLOIT Actiontec C1000A backdoor account M2"; flow:established,to_server; content:"CenturyL1nk"; fast_pattern; classtype:attempted-admin; sid:2024980; rev:3; metadata:affected_product Linux, attack_target IoT, created_at 2017_11_13, deployment Perimeter, malware_family Mirai, performance_impact Low, confidence Low, signature_severity Critical, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-exploit.rules
#alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ET EXPLOIT M3U File Request Flowbit Set"; flow:to_server,established; content:"GET "; depth:4; content:".m3u"; http_uri; flowbits:set,ET.m3u.download; flowbits:noalert; classtype:not-suspicious; sid:2011241; rev:3; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_08_22;)

#alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET EXPLOIT HP OpenView NNM snmpviewer.exe CGI Stack Buffer Overflow 2"; flow:to_server,established; content:"POST "; nocase; depth:5; content:"/OvCgi/snmpviewer.exe"; http_uri; nocase; content:"app="; nocase; content:"act="; nocase; isdataat:257,relative; content:!"|0A|"; within:257; pcre:"/act\x3D[^\x26\s\r\n]{257}/i"; reference:cve,CVE-2010-1552; reference:bugtraq,40068; classtype:attempted-admin; sid:2012683; rev:6; metadata:created_at 2010_09_25, confidence High, signature_severity Major, updated_at 2019_08_22;)

#alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET EXPLOIT HP OpenView NNM snmpviewer.exe CGI Stack Buffer Overflow 1"; flow:to_server,established; content:"POST "; nocase; depth:5; content:"/OvCgi/snmpviewer.exe"; http_uri; nocase; content:"act="; nocase; content:"app="; nocase; isdataat:257,relative; content:!"|0A|"; within:257; pcre:"/app\x3D[^\x26\s\r\n]{257}/i"; reference:cve,CVE-2010-1552; reference:bugtraq,40068; classtype:attempted-admin; sid:2012682; rev:7; metadata:created_at 2010_09_25, confidence High, signature_severity Major, updated_at 2019_08_22;)

alert tcp $EXTERNAL_NET any -> $HOME_NET 23 (msg:"ET EXPLOIT HiSilicon DVR - Default Telnet Root Password Inbound"; flow:established,to_server; content:"xc3511"; fast_pattern; reference:url,github.com/tothi/pwn-hisilicon-dvr; classtype:default-login-attempt; sid:2027973; rev:2; metadata:affected_product DVR, attack_target IoT, created_at 2019_09_09, deployment Perimeter, signature_severity Major, updated_at 2019_09_09;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [554,9527] (msg:"ET EXPLOIT HiSilicon DVR - Default Application Backdoor Password"; flow:established,to_server; content:"I0TO5Wv9"; fast_pattern; reference:url,github.com/tothi/pwn-hisilicon-dvr; classtype:default-login-attempt; sid:2027974; rev:2; metadata:affected_product DVR, attack_target IoT, created_at 2019_09_09, deployment Perimeter, performance_impact Low, confidence High, signature_severity Major, updated_at 2019_09_09;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Netlink GPON Remote Code Execution Attempt (Inbound)"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:23; content:"/boaform/admin/formPing"; fast_pattern; http.request_body; content:"target_addr=|3b|"; startswith; reference:url,blog.netlab.360.com/multiple-fiber-routers-are-being-compromised-by-botnets-using-0-day-en/; reference:url,www.exploit-db.com/exploits/48225; classtype:attempted-admin; sid:2029976; rev:2; metadata:affected_product Router, attack_target Networking_Equipment, created_at 2020_04_20, deployment Perimeter, performance_impact Low, confidence High, signature_severity Major, updated_at 2020_04_20, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Attempted D-Link ShareCenter (DNS-320/325) RCE (Inbound)"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/cgi-bin/system_mgr.cgi?cmd=cgi_sms_test&command1="; startswith; fast_pattern; reference:url,roberto.greyhats.it/advisories/20120208-dlink-rce.txt/; classtype:web-application-attack; sid:2030120; rev:1; metadata:affected_product Router, attack_target Client_Endpoint, created_at 2020_05_07, deployment Perimeter, confidence High, signature_severity Major, updated_at 2020_05_07;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Netgear WNDR Router DNS Change POST Request"; flow:to_server,established; urilen:26; http.method; content:"POST"; http.uri; content:"/apply.cgi?/BAS_update.htm"; http.request_body; content:"submit_flag=ether"; depth:17; fast_pattern; content:"&ether_dnsaddr1="; distance:0; nocase; content:"&Apply=Apply"; distance:0; reference:url,www.s3cur1ty.de/node/640; classtype:attempted-admin; sid:2020859; rev:5; metadata:created_at 2015_04_08, signature_severity Major, updated_at 2020_05_21;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-LINK Known Malicious Router DNS Change GET Request"; flow:to_server,established; http.method; content:"GET"; http.uri; content:"/basic/uiViewIPAddr="; fast_pattern; content:"&uiViewDns1Mark="; distance:0; content:"&uiViewDns2Mark="; distance:0; reference:url,pastebin.com/u0MRLmjp; classtype:attempted-admin; sid:2020872; rev:4; metadata:created_at 2015_04_09, signature_severity Major, updated_at 2020_05_21;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT D-link DI604 Known Malicious Router DNS Change GET Request"; flow:to_server,established; http.method; content:"GET"; http.uri; content:"/prim.htm?"; depth:10; fast_pattern; nocase; content:"i00110004="; distance:0; content:"&i00110005="; distance:0; nocase; content:"&i00035007="; distance:0; nocase; reference:url,www.gnucitizen.org/blog/router-hacking-challenge; classtype:attempted-admin; sid:2020873; rev:4; metadata:created_at 2015_04_09, signature_severity Major, updated_at 2020_05_21;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-LINK TL-WR841N Router DNS Change GET Request"; flow:to_server,established; http.method; content:"GET"; http.uri; content:"/userRpm/LanDhcpServerRpm.htm?"; fast_pattern; content:"dhcpserver=1"; content:"&dnsserver="; content:"&Save="; reference:url,www.exploit-db.com/exploits/34584; classtype:attempted-admin; sid:2020878; rev:4; metadata:created_at 2015_04_09, signature_severity Major, updated_at 2020_05_21;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-LINK TL-WR750N DNS Change GET Request"; flow:to_server,established; http.method; content:"GET"; http.uri; content:"/userRpm/WanStaticIpCfgRpm.htm"; fast_pattern; content:"&dnsserver="; content:"&Save=Save"; reference:url,www.xexexe.cz/2015/02/bruteforcing-tp-link-routers-with.html; classtype:attempted-admin; sid:2020880; rev:4; metadata:created_at 2015_04_09, signature_severity Major, updated_at 2020_05_21;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Netgear Multiple Router Auth Bypass"; flow:to_server,established; http.uri; content:"/BRS_netgear_success.html"; depth:25; nocase; fast_pattern; reference:url,www.shellshocklabs.com/2015/09/part-1en-hacking-netgear-jwnr2010v5.html; classtype:attempted-admin; sid:2021944; rev:3; metadata:created_at 2015_10_12, signature_severity Major, updated_at 2020_06_02;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT TP-LINK Archer C5 v4 (CVE-2019-7405)"; flow:established,to_server; http.uri; content:"/cgi/setPwd?pwd="; http.referer; bsize:14; content:"tplinkwifi.net"; fast_pattern; reference:cve,2019-7405; reference:url,securityintelligence.com/posts/tp-link-archer-router-vulnerability-voids-admin-password-can-allow-remote-takeover/; classtype:attempted-admin; sid:2029181; rev:3; metadata:affected_product Router, attack_target Networking_Equipment, created_at 2019_12_17, cve CVE_2019_7405, deployment Perimeter, performance_impact Low, confidence Medium, signature_severity Major, updated_at 2020_06_08;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Netgear ReadyNAS Surveillance Unauthenticated Remote Command Execution"; flow:to_server,established; http.uri; content:"/upgrade_handle.php?cmd=writeuploaddir&uploaddir="; startswith; reference:url,blogs.securiteam.com/index.php/archives/3409; reference:cve,CVE-2017-18377; classtype:attempted-recon; sid:2024914; rev:3; metadata:attack_target IoT, created_at 2017_10_25, deployment Perimeter, confidence Medium, signature_severity Major, updated_at 2020_06_08;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Multiple DLink Routers Remote Code Execution CVE-2019-16920"; flow:to_server,established; urilen:14; http.method; content:"POST"; http.uri; content:"/apply_sec.cgi"; http.request_body; content:"html_response_page=login_pic.asp&action=ping_test&ping_ipaddr="; fast_pattern; reference:cve,2019-16920; reference:url,www.fortinet.com/blog/threat-research/d-link-routers-found-vulnerable-rce; classtype:attempted-admin; sid:2030277; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2020_06_10, cve CVE_2019_16920, deployment Perimeter, confidence High, signature_severity Major, tag CISA_KEV, updated_at 2020_06_10, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Possible D-Link Command Injection Attempt Inbound (CVE-2020-13782)"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"_ajax_explorer.sgi?action="; fast_pattern; content:"&path="; distance:0; content:"&where="; distance:0; content:"&en=|3b|"; distance:0; reference:url,unit42.paloaltonetworks.com/6-new-d-link-vulnerabilities-found-on-home-routers/; reference:cve,2020-13782; classtype:attempted-admin; sid:2030335; rev:1; metadata:attack_target Networking_Equipment, created_at 2020_06_15, cve CVE_2020_13782, deployment Perimeter, deployment Internal, performance_impact Low, confidence Low, signature_severity Major, updated_at 2020_06_15, mitre_tactic_id TA0008, mitre_tactic_name Lateral_Movement, mitre_technique_id T1210, mitre_technique_name Exploitation_Of_Remote_Services;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [9530,9527,23] (msg:"ET EXPLOIT Attempted HiSilicon DVR/NVR/IPCam RCE (Inbound)"; flow:established,to_server; dsize:21; content:"|15 4f 70 65 6e 54 65 6c 6e 65 74 3a 4f 70 65 6e 4f 6e 63 65 00|"; reference:url,github.com/Snawoot/hisilicon-dvr-telnet/blob/master/hs-dvr-telnet.c; reference:url,habr.com/en/post/486856/; classtype:attempted-admin; sid:2030487; rev:1; metadata:affected_product IoT, attack_target Client_Endpoint, created_at 2020_07_09, deployment Perimeter, confidence High, signature_severity Major, updated_at 2020_07_09;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert tcp $HOME_NET any -> $EXTERNAL_NET [9530,9527,23] (msg:"ET EXPLOIT Attempted HiSilicon DVR/NVR/IPCam RCE (Outbound)"; flow:established,to_server; dsize:21; content:"|15 4f 70 65 6e 54 65 6c 6e 65 74 3a 4f 70 65 6e 4f 6e 63 65 00|"; reference:url,github.com/Snawoot/hisilicon-dvr-telnet/blob/master/hs-dvr-telnet.c; reference:url,habr.com/en/post/486856/; classtype:attempted-admin; sid:2030488; rev:1; metadata:affected_product IoT, attack_target Client_Endpoint, created_at 2020_07_09, deployment Perimeter, confidence High, signature_severity Major, updated_at 2020_07_09;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> [$HTTP_SERVERS,$HOME_NET] any (msg:"ET EXPLOIT Attempted Netgear Buffer Overflow into RCE Inbound M1"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/upgrade_check.cgi"; bsize:18; http.content_len; byte_test:0,>,4000,0,string,dec; http.request_body; content:"mknod|20 2f|dev/ptyp"; fast_pattern; reference:url,github.com/grimm-co/NotQuite0dayFriday/blob/master/2020.06.15-netgear/exploit.py; classtype:attempted-admin; sid:2030630; rev:1; metadata:affected_product Netgear_Router, created_at 2020_07_31, deployment Perimeter, confidence High, signature_severity Major, tag Exploit, updated_at 2020_07_31;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> [$HTTP_SERVERS,$HOME_NET] any (msg:"ET EXPLOIT Attempted Netgear Buffer Overflow into RCE Inbound M2"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/upgrade_check.cgi"; bsize:18; fast_pattern; http.content_len; byte_test:0,>,1000,0,string,dec; http.request_body; content:"/bin/"; reference:url,github.com/grimm-co/NotQuite0dayFriday/blob/master/2020.06.15-netgear/exploit.py; classtype:attempted-admin; sid:2030631; rev:1; metadata:affected_product Netgear_Router, created_at 2020_07_31, deployment Perimeter, confidence High, signature_severity Major, tag Exploit, updated_at 2020_07_31;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Netgear R7000 Command Injection Exploit"; flow:established,to_server; http.uri; content:"/cgi-bin/"; depth:9; content:"$IFS"; fast_pattern; distance:0; content:"|3b|"; reference:url,www.kb.cert.org/vuls/id/582384; classtype:attempted-user; sid:2023628; rev:3; metadata:affected_product Netgear_Router, attack_target Networking_Equipment, created_at 2016_12_12, deployment Perimeter, performance_impact Low, signature_severity Major, updated_at 2020_08_03, mitre_tactic_id TA0008, mitre_tactic_name Lateral_Movement, mitre_technique_id T1210, mitre_technique_name Exploitation_Of_Remote_Services;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-LINK DNS Change GET Request (DNSChanger EK)"; flow:to_server,established; threshold:type both,track by_dst,count 3, seconds 90; http.method; content:"GET"; http.uri; content:"/userRpm/"; depth:9; fast_pattern; content:"&dnsserver="; reference:url,www.xexexe.cz/2015/02/bruteforcing-tp-link-routers-with.html; classtype:attempted-admin; sid:2023995; rev:2; metadata:affected_product Linux, attack_target Networking_Equipment, created_at 2017_02_17, deployment Internet, performance_impact Moderate, signature_severity Major, updated_at 2020_08_04;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-Link Archer C2 and Archer C20i Remote Code Execution"; flow:to_server,established; http.method; content:"POST"; http.uri; content:"/cgi?"; nocase; http.header; content:"/mainFrame.htm"; http.request_body; content:"IPPING"; nocase; content:"X_TP_ConnName=ewan_ipoe_s"; fast_pattern; reference:url,github.com/reverse-shell/routersploit/blob/master/routersploit/modules/exploits/tplink/archer_c2_c20i_rce.py; classtype:command-and-control; sid:2024191; rev:3; metadata:affected_product TPLINK, attack_target Client_Endpoint, created_at 2017_04_07, deployment Perimeter, performance_impact Low, confidence Medium, signature_severity Major, updated_at 2020_08_05, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT D-Link 850L Password Extract Attempt"; flow:to_server,established; urilen:11; http.method; content:"POST"; http.uri; content:"/hedwig.cgi"; fast_pattern; http.request_body; content:"DEVICE.ACCOUNT"; reference:url,blogs.securiteam.com/index.php/archives/3364; classtype:attempted-recon; sid:2024913; rev:3; metadata:attack_target IoT, created_at 2017_10_25, deployment Perimeter, signature_severity Major, updated_at 2020_08_13;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Netgear DGN Remote Command Execution"; flow:to_server,established; http.uri; content:"/setup.cgi?next_file="; nocase; content:"&todo=syscmd&cmd="; nocase; distance:0; content:"currentsetting.htm"; nocase; fast_pattern; reference:url,seclists.org/bugtraq/2013/Jun/8; classtype:attempted-recon; sid:2024916; rev:2; metadata:attack_target IoT, created_at 2017_10_25, deployment Perimeter, confidence Medium, signature_severity Major, updated_at 2020_08_13;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET 52869 (msg:"ET EXPLOIT Realtek SDK Miniigd UPnP SOAP Command Execution CVE-2014-8361"; flow:established,to_server; urilen:12; http.method; content:"POST"; http.uri; content:"/picdesc.xml"; http.header; content:"SOAPAction|3a 20|urn|3a|schemas-upnp-org|3a|service|3a|WANIPConnection|3a|"; reference:url,blog.netlab.360.com/warning-satori-a-new-mirai-variant-is-spreading-in-worm-style-on-port-37215-and-52869-en/; reference:cve,CVE-2014-8361; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/realtek_miniigd_upnp_exec_noauth.rb; reference:url,www.exploit-db.com/exploits/37169/; classtype:attempted-user; sid:2025132; rev:3; metadata:attack_target IoT, created_at 2017_12_05, confidence Medium, signature_severity Major, tag CISA_KEV, updated_at 2020_08_24;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT TP-Link Technologies TL-WA850RE Wi-Fi Range Extender - Command Execution"; flow:to_server,established; http.uri; content:"/wps.setup.json"; fast_pattern; nocase; http.request_body; content:"operation=write"; content:"option=connect"; content:"wps_setup_pin="; content:"%2Fbin%2Fsh"; reference:url,exploit-db.com/exploits/44912/; classtype:web-application-attack; sid:2025735; rev:3; metadata:affected_product TPLINK, attack_target IoT, created_at 2018_06_22, deployment Datacenter, performance_impact Low, confidence Medium, signature_severity Major, updated_at 2020_08_25;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-Link TL-WR840N/TL-WR841N - Authentication Bypass (Reboot Router)"; flow:established,to_server; http.uri; content:"/cgi?7"; http.header; content:"mainFrame.htm"; http.request_body; content:"ACT_REBOOT"; fast_pattern; reference:url,exploit-db.com/exploits/44781/; classtype:attempted-user; sid:2025754; rev:3; metadata:affected_product TPLINK, created_at 2018_06_26, deployment Perimeter, deployment Internal, deployment Datacenter, confidence High, signature_severity Major, updated_at 2020_08_25, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT D-Link DSL-2750B - OS Command Injection"; flow:established,to_server; http.uri; content:"/login.cgi?cli="; pcre:"/^[ a-zA-Z0-9+_]*[\x27\x3b]/Ri"; reference:url,exploit-db.com/exploits/44760/; classtype:attempted-user; sid:2025756; rev:3; metadata:attack_target IoT, created_at 2018_06_27, deployment Datacenter, performance_impact Low, confidence High, signature_severity Major, updated_at 2020_08_25, mitre_tactic_id TA0008, mitre_tactic_name Lateral_Movement, mitre_technique_id T1210, mitre_technique_name Exploitation_Of_Remote_Services;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT D-Link DIR601 2.02 Credential Disclosure"; flow:established,to_server; http.uri; content:"/my_cgi.cgi"; http.request_body; content:"request=no_auth"; content:"request=load_settings"; content:"table_name=admin_user"; fast_pattern; content:"table_name=user_user"; content:"table_name=wireless_settings"; content:"table_name=wireless_security"; content:"table_name=wireless_wpa_settings"; reference:url,exploit-db.com/exploits/45002/; classtype:attempted-recon; sid:2025823; rev:3; metadata:attack_target IoT, created_at 2018_07_10, deployment Datacenter, performance_impact Low, confidence High, signature_severity Major, updated_at 2020_08_25;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET EXPLOIT Realtek SDK Miniigd UPnP SOAP Command Execution CVE-2014-8361 - Outbound"; flow:established,to_server; http.method; content:"POST"; http.header; content:"SOAPAction|3a 20|urn|3a|schemas-upnp-org|3a|service|3a|WANIPConnection|3a|"; fast_pattern; http.request_body; content:"|3c|u|3a|AddPortMapping"; content:"|3c|NewRemoteHost|3e|"; distance:0; content:"|3c|NewInternalClient"; distance:0; content:"|3c 2f|NewInternalClient|3e|"; distance:0; content:"NewEnabled|3e|1"; distance:0; classtype:trojan-activity; sid:2027339; rev:3; metadata:attack_target IoT, created_at 2019_05_08, cve CVE_2014_8361, deployment Perimeter, performance_impact Low, confidence Medium, signature_severity Major, tag CISA_KEV, updated_at 2020_08_31;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-LINK Password Change GET Request (DNSChanger EK)"; flow:to_server,established; threshold:type limit,track by_dst,count 3, seconds 90; http.method; content:"GET"; http.uri; content:"/router/UserPassSet.cgi?"; depth:24; fast_pattern; content:"new_user_name="; content:"password1="; reference:url,www.xexexe.cz/2015/02/bruteforcing-tp-link-routers-with.html; classtype:attempted-admin; sid:2023996; rev:4; metadata:affected_product Linux, attack_target Networking_Equipment, created_at 2017_02_17, deployment Internal, performance_impact Moderate, signature_severity Major, updated_at 2020_09_04;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT HackingTrio UA (Hello, World)"; flow:established,to_server; http.method; content:"POST"; http.user_agent; content:"Hello, World"; fast_pattern; endswith; reference:cve,2018-10561; reference:cve,2018-10562; reference:url,github.com/f3d0x0/GPON; classtype:attempted-admin; sid:2025576; rev:4; metadata:attack_target IoT, created_at 2018_05_11, cve CVE_2018_10561, deployment Perimeter, performance_impact Low, signature_severity Major, tag GPON, updated_at 2020_09_16;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible Netgear DGN2200 RCE (CVE-2017-6077)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/ping.cgi"; depth:9; endswith; http.header; content:"DIAG_diag.htm|0d 0a|"; fast_pattern; http.request_body; content:"&ping_IPAddr="; content:"|3b|"; distance:0; reference:url,www.exploit-db.com/exploits/41394; reference:cve,2017-6077; classtype:attempted-user; sid:2027093; rev:3; metadata:attack_target IoT, created_at 2019_03_18, cve CVE_2017_6077, deployment Perimeter, performance_impact Low, confidence Medium, signature_severity Major, tag CISA_KEV, updated_at 2020_09_16;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible Netgear DGN2200 RCE (CVE-2017-6334)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/dnslookup.cgi"; depth:14; endswith; http.header; content:"DIAG_diag.htm|0d 0a|"; fast_pattern; http.request_body; content:"host_name="; depth:10; content:"|3b|"; distance:0; reference:url,www.exploit-db.com/exploits/41394; reference:cve,2017-6334; classtype:attempted-user; sid:2027094; rev:3; metadata:attack_target IoT, created_at 2019_03_18, cve CVE_2017_6334, deployment Perimeter, performance_impact Low, confidence Medium, signature_severity Major, tag CISA_KEV, updated_at 2020_09_16;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT NETGEAR R7000/R6400 - Command Injection Inbound (CVE-2019-6277)"; flow:to_server,established; http.method; content:"GET"; http.uri; content:"/cgi-bin/|3b|wget"; depth:14; fast_pattern; content:"|7c|sh"; endswith; http.header_names; content:!"Referer"; reference:url,www.exploit-db.com/exploits/41598; reference:cve,CVE-2016-6277; classtype:attempted-admin; sid:2027881; rev:4; metadata:affected_product Netgear_Router, attack_target IoT, created_at 2019_08_13, deployment Perimeter, malware_family Mirai, performance_impact Low, signature_severity Major, updated_at 2020_09_17, mitre_tactic_id TA0008, mitre_tactic_name Lateral_Movement, mitre_technique_id T1210, mitre_technique_name Exploitation_Of_Remote_Services;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> any any (msg:"ET EXPLOIT NETGEAR R7000/R6400 - Command Injection Outbound (CVE-2019-6277)"; flow:to_server,established; http.method; content:"GET"; http.uri; content:"/cgi-bin/|3b|wget"; depth:14; fast_pattern; content:"|7c|sh"; endswith; http.header_names; content:!"Referer"; reference:url,www.exploit-db.com/exploits/41598; reference:cve,CVE-2016-6277; classtype:attempted-admin; sid:2027882; rev:4; metadata:affected_product Netgear_Router, attack_target IoT, created_at 2019_08_13, deployment Perimeter, malware_family Mirai, performance_impact Low, signature_severity Major, updated_at 2020_09_17, mitre_tactic_id TA0008, mitre_tactic_name Lateral_Movement, mitre_technique_id T1210, mitre_technique_name Exploitation_Of_Remote_Services;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT D-Link IP Camera Vulnerable HTTP Request (CVE-2013-1599)"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/cgi-bin/rtpd.cgi?"; fast_pattern; reference:url,www.coresecurity.com/advisories/d-link-ip-cameras-multiple-vulnerabilities; classtype:attempted-admin; sid:2019801; rev:4; metadata:created_at 2014_11_25, cve CVE_2013_1599, signature_severity Major, updated_at 2020_09_28;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT D-Link IP Camera Vulnerable HTTP Request (CVE-2013-1600)"; flow:established,to_server; urilen:17; http.method; content:"GET"; http.uri; content:"/upnp/asf-mp4.asf"; fast_pattern; reference:url,www.coresecurity.com/advisories/d-link-ip-cameras-multiple-vulnerabilities; classtype:attempted-admin; sid:2019802; rev:4; metadata:created_at 2014_11_25, cve CVE_2013_1600, signature_severity Major, updated_at 2020_09_28;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT D-Link IP Camera Vulnerable HTTP Request (CVE-2013-1601)"; flow:established,to_server; urilen:12; http.method; content:"GET"; http.uri; content:"/md/lums.cgi"; fast_pattern; reference:url,www.coresecurity.com/advisories/d-link-ip-cameras-multiple-vulnerabilities; classtype:attempted-admin; sid:2019803; rev:4; metadata:created_at 2014_11_25, cve CVE_2013_1601, signature_severity Major, updated_at 2020_09_28;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Generic ADSL Router DNS Change GET Request"; flow:to_server,established; http.method; content:"GET"; http.uri; content:"dnsPrimary="; fast_pattern; content:"&dnsSecondary="; content:"&dnsDynamic="; content:"&dnsRefresh="; reference:url,packetstormsecurity.com/files/130418/dlink-DSL2640B.txt; classtype:attempted-user; sid:2020487; rev:4; metadata:created_at 2015_02_19, confidence Medium, signature_severity Major, updated_at 2020_09_29;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Netgear DGN1000B Router DNS Change GET Request"; flow:to_server,established; http.method; content:"GET"; http.uri; content:"/setup.cgi?todo=wan_dns1="; fast_pattern; reference:url,www.rapid7.com/db/modules/exploit/linux/http/netgear_dgn1000b_setup_exec; classtype:attempted-admin; sid:2020874; rev:5; metadata:created_at 2015_04_09, signature_severity Major, updated_at 2020_09_30;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Tenda ADSL2/2+ Router DNS Change GET Request"; flow:to_server,established; http.method; content:"GET"; http.uri; content:"/apply.cgi?wan_primary_dns="; fast_pattern; content:"&wan_secondary_dns="; reference:url,malwr.com/analysis/MGY1ZDFhYjE1MzQ4NDAwM2EyZTI5YmY3MWZjMWE5OGM; classtype:attempted-admin; sid:2020876; rev:4; metadata:created_at 2015_04_09, signature_severity Major, updated_at 2020_09_30;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET 8080 (msg:"ET EXPLOIT Linksys Router Unauthenticated Remote Code Execution"; flow:to_server,established; http.method; content:"POST"; http.uri; content:".cgi"; nocase; http.header; content:"Authorization|3a 20|Basic"; http.request_body; content:"%74%74%63%70%5f%69%70%3d%2d%68%20%60"; fast_pattern; reference:url,sans.org/reading-room/whitepapers/malicious/analyzing-backdoor-bot-mips-platform-35902; classtype:attempted-user; sid:2022758; rev:4; metadata:created_at 2016_04_25, confidence Medium, signature_severity Major, updated_at 2020_10_06, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> any [5555,7547] (msg:"ET EXPLOIT Eir D1000 Modem CWMP Exploit Retrieving Wifi Key"; flow:to_server,established; http.header; content:"urn|3a|dslforum-org|3a|service|3a|Time|3a|1#SetNTPServers"; nocase; fast_pattern; http.request_body; content:"|3c 75 3a 47 65 74 53 65 63 75 72 69 74 79 4b 65 79 73|"; reference:url,devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/; reference:md5,a19d5b596992407796a33c5e15489934; classtype:trojan-activity; sid:2023549; rev:5; metadata:affected_product Eir_D1000_Modem, attack_target Networking_Equipment, created_at 2016_11_28, deployment Perimeter, performance_impact Low, confidence High, signature_severity Major, updated_at 2020_10_07;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-LINK TL-WR340G Router DNS Change GET Request"; flow:to_server,established; http.method; content:"GET"; http.uri; content:"/userRpm/WanDynamicIpCfgRpm.htm?"; depth:32; content:"&dnsserver="; content:"&Save=Save"; fast_pattern; reference:url,www.exploit-db.com/exploits/34583; classtype:attempted-admin; sid:2020856; rev:5; metadata:created_at 2015_04_08, signature_severity Major, updated_at 2020_10_13;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET EXPLOIT Netgear DGN1000/DGN2200 Unauthenticated Command Execution Outbound"; flow:established,to_server; http.uri; content:"/setup.cgi?next_file=netgear.cfg&todo=syscmd&cmd="; depth:49; reference:url,www.exploit-db.com/exploits/25978; classtype:attempted-admin; sid:2029215; rev:2; metadata:affected_product Netgear_Router, attack_target IoT, created_at 2019_12_31, deployment Perimeter, confidence Medium, signature_severity Major, updated_at 2020_10_27;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT NETGEAR WNR2000v5 hidden_lang_avi Stack Overflow (CVE-2016-10174)"; flow:to_server,established; http.uri; content:"/lang_check.html"; content:"timestamp="; http.request_body; content:"&hidden_lang_avi="; isdataat:36,relative; content:!"|00|"; within:36; content:!"|25|"; within:36; content:!"|26|"; within:36; classtype:attempted-admin; sid:2024121; rev:6; metadata:affected_product Netgear_Router, attack_target Client_Endpoint, created_at 2017_03_30, cve CVE_2016_10174, deployment Perimeter, performance_impact Low, confidence High, signature_severity Major, tag CISA_KEV, updated_at 2020_11_05; target:dest_ip;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Belkin Wemo Enabled Crock-Pot Unauthenticated Command Injection Inbound (CVE-2019-12780)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/upnp/control/basicevent1"; depth:25; endswith; http.header; content:"SOAPAction|3a 20|"; content:"urn|3a|Belkin|3a|service|3a|basicevent|3a|1|23|SetSmartDevInfo"; within:48; fast_pattern; http.request_body; content:"|3c|SmartDevURL|3e 60|"; reference:cve,CVE-2019-12780; reference:md5,d6ebabf44849951d754ee2de15a24b92; reference:url,blogs.akamai.com/sitr/2019/06/latest-echobot-26-infection-vectors.html; classtype:attempted-admin; sid:2027486; rev:4; metadata:attack_target IoT, created_at 2019_06_18, deployment Perimeter, performance_impact Low, signature_severity Major, updated_at 2020_11_19, mitre_tactic_id TA0008, mitre_tactic_name Lateral_Movement, mitre_technique_id T1210, mitre_technique_name Exploitation_Of_Remote_Services;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET EXPLOIT Belkin Wemo Enabled Crock-Pot Unauthenticated Command Injection Outbound (CVE-2019-12780)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/upnp/control/basicevent1"; depth:25; endswith; http.header; content:"SOAPAction|3a 20|"; content:"urn|3a|Belkin|3a|service|3a|basicevent|3a|1|23|SetSmartDevInfo"; within:48; http.request_body; content:"|3c|SmartDevURL|3e 60|"; reference:cve,CVE-2019-12780; reference:md5,d6ebabf44849951d754ee2de15a24b92; reference:url,blogs.akamai.com/sitr/2019/06/latest-echobot-26-infection-vectors.html; classtype:attempted-admin; sid:2027487; rev:4; metadata:attack_target IoT, created_at 2019_06_18, deployment Perimeter, performance_impact Low, signature_severity Major, updated_at 2020_11_19, mitre_tactic_id TA0008, mitre_tactic_name Lateral_Movement, mitre_technique_id T1210, mitre_technique_name Exploitation_Of_Remote_Services;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET EXPLOIT MiCasaVerde VeraLite - Remote Code Execution Outbound (CVE-2016-6255)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/upnp/control/hag"; depth:17; endswith; fast_pattern; http.header; content:"SOAPAction|3a 20|"; content:"urn|3a|schemas-micasaverde-org|3a|service|3a|HomeAutomationGateway|3a|1|23|RunLua"; within:67; http.request_body; content:"|3c|Code|3e|os|2e|execute|28 60|"; reference:cve,CVE-2019-12780; reference:md5,d6ebabf44849951d754ee2de15a24b92; reference:url,blogs.akamai.com/sitr/2019/06/latest-echobot-26-infection-vectors.html; classtype:attempted-admin; sid:2027488; rev:5; metadata:attack_target IoT, created_at 2019_06_18, deployment Perimeter, malware_family Mirai, performance_impact Low, confidence Medium, signature_severity Major, updated_at 2020_11_19, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT MiCasaVerde VeraLite - Remote Code Execution Inbound (CVE-2016-6255)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/upnp/control/hag"; depth:17; endswith; fast_pattern; http.header; content:"SOAPAction|3a 20|"; content:"urn|3a|schemas-micasaverde-org|3a|service|3a|HomeAutomationGateway|3a|1|23|RunLua"; within:67; http.request_body; content:"|3c|Code|3e|os|2e|execute|28 60|"; reference:cve,CVE-2019-12780; reference:md5,d6ebabf44849951d754ee2de15a24b92; reference:url,blogs.akamai.com/sitr/2019/06/latest-echobot-26-infection-vectors.html; classtype:attempted-admin; sid:2027489; rev:5; metadata:attack_target IoT, created_at 2019_06_18, deployment Perimeter, malware_family Mirai, performance_impact Low, confidence Medium, signature_severity Major, updated_at 2020_11_19, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT D-Link DI-804HV DNS Changer Exploit Attempt"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/cgi-bin/prim"; startswith; content:"prim&rf=0004&"; fast_pattern; content:"&ID00="; distance:0; content:"&ID01="; distance:0; reference:url,cujo.com/dns-hijacking-attacks-on-home-routers-in-brazil/; classtype:attempted-admin; sid:2031809; rev:1; metadata:affected_product Router, attack_target Networking_Equipment, created_at 2021_03_04, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag DNS_Hijack, updated_at 2021_03_04;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert udp any any -> $HOME_NET 1900 (msg:"ET EXPLOIT DD-WRT UPNP Unauthenticated Buffer Overflow (CVE-2021-27137)"; content:"M-SEARCH|20|"; startswith; content:"|0d 0a|ST|3a|"; nocase; fast_pattern; content:"uuid|3a|"; distance:0; within:6; pcre:"/^[^\r\n]{128,}\r\n/R"; reference:url,ssd-disclosure.com/ssd-advisory-dd-wrt-upnp-buffer-overflow/; reference:cve,2021-27137; classtype:attempted-admin; sid:2032326; rev:1; metadata:attack_target Networking_Equipment, created_at 2021_03_25, cve CVE_2021_27137, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, updated_at 2021_03_25;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET EXPLOIT Possible Realtek SDK - Stack Buffer Overflow via UPnP SUBSCRIBE Callback Header Inbound (CVE-2021-35393)"; flow:established,to_server; http.method; content:"SUBSCRIBE"; http.uri; content:"/upnp/"; http.header; content:"Callback|3a 20 3c|http"; fast_pattern; pcre:"/^Callback\x3a\x20\x3chttp[^\x3a]+\x3a\d{1,5}[^\/]/Hmi"; reference:url,www.iot-inspector.com/blog/advisory-multiple-issues-realtek-sdk-iot-supply-chain/; reference:cve,2021-35393; classtype:attempted-user; sid:2033843; rev:1; metadata:attack_target Server, created_at 2021_08_30, cve CVE_2021_35393, deployment Perimeter, deployment Internal, confidence Medium, signature_severity Major, tag Exploit, updated_at 2021_08_30, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TOTOLINK Router Cross-site Scripting CVE-2021-34228 (boafrm) M1"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/boafrm/"; fast_pattern; http.request_body; content:"=%3E%3Cscript%3E"; reference:url,github.com/pup2y/IoTVul/tree/main/TOTOLINK/A3002R; reference:cve,2021-34228; classtype:web-application-attack; sid:2033845; rev:1; metadata:affected_product Router, attack_target Client_Endpoint, created_at 2021_08_30, cve CVE_2021_34228, deployment Perimeter, confidence High, signature_severity Major, updated_at 2021_08_30;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TOTOLINK Router Cross-site Scripting CVE-2021-34228 (boafrm) M2"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/boafrm/"; fast_pattern; http.request_body; content:"=%22%3E%3Cscript%3E"; reference:url,github.com/pup2y/IoTVul/tree/main/TOTOLINK/A3002R; reference:cve,2021-34228; classtype:web-application-attack; sid:2033846; rev:1; metadata:affected_product Router, attack_target Client_Endpoint, created_at 2021_08_30, cve CVE_2021_34228, deployment Perimeter, confidence High, signature_severity Major, updated_at 2021_08_30;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TOTOLINK Router Cross-site Scripting CVE-2021-34228 (boafrm) M3"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/boafrm/"; fast_pattern; http.request_body; content:"=%27%3E%3Cscript%3E"; reference:url,github.com/pup2y/IoTVul/tree/main/TOTOLINK/A3002R; reference:cve,2021-34228; classtype:web-application-attack; sid:2033847; rev:1; metadata:affected_product Router, attack_target Client_Endpoint, created_at 2021_08_30, cve CVE_2021_34228, deployment Perimeter, confidence High, signature_severity Major, updated_at 2021_08_30;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TOTOLINK Router Cross-site Scripting CVE-2021-34228 (boafrm) M4"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/boafrm/"; fast_pattern; http.request_body; content:"=|22 3e 3c|script|3e|"; reference:url,github.com/pup2y/IoTVul/tree/main/TOTOLINK/A3002R; reference:cve,2021-34228; classtype:web-application-attack; sid:2033848; rev:1; metadata:affected_product Router, attack_target Client_Endpoint, created_at 2021_08_30, cve CVE_2021_34228, deployment Perimeter, confidence High, signature_severity Major, updated_at 2021_08_30;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET EXPLOIT UPnP UUID Password Change Exploit Attempt Inbound - XR300 PoC Gadgets (CVE-2021-34991)"; flow:established,to_server; http.method; content:"SUBSCRIBE"; http.header; content:"UUID|3a 20|"; fast_pattern; http.request_body; content:"|b7 05 00|"; content:"|e0 e7 02|"; distance:10; within:10; reference:url,kb.netgear.com/000064361/Security-Advisory-for-Pre-Authentication-Buffer-Overflow-on-Multiple-Products-PSV-2021-0168; reference:url,blog.grimm-co.com/2021/11/seamlessly-discovering-netgear.html; reference:cve,2021-34991; classtype:attempted-admin; sid:2034493; rev:2; metadata:attack_target Server, created_at 2021_11_18, cve CVE_2021_34991, deployment Perimeter, deployment Internal, confidence High, signature_severity Major, tag Exploit, updated_at 2021_11_18, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET EXPLOIT UPnP UUID Password Change Exploit Attempt Inbound - R6700V3 PoC Gadgets (CVE-2021-34991)"; flow:established,to_server; http.method; content:"SUBSCRIBE"; http.header; content:"UUID|3a 20|"; fast_pattern; http.request_body; content:"|d0|j|06 00|"; content:"|81 01 00|"; distance:10; within:10; reference:url,kb.netgear.com/000064361/Security-Advisory-for-Pre-Authentication-Buffer-Overflow-on-Multiple-Products-PSV-2021-0168; reference:url,blog.grimm-co.com/2021/11/seamlessly-discovering-netgear.html; reference:cve,2021-34991; classtype:attempted-admin; sid:2034494; rev:1; metadata:attack_target Server, created_at 2021_11_18, cve CVE_2021_34991, deployment Perimeter, deployment Internal, confidence High, signature_severity Major, tag Exploit, updated_at 2021_11_18, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Netgear DGN Remote Code Execution (CVE-2024-12847)"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/setup.cgi?next_file=netgear.cfg&todo=syscmd&cmd="; fast_pattern; startswith; content:"&curpath=/&currentsetting.htm=1"; endswith; http.header_names; content:!"Referer"; content:!"User-Agent"; reference:url,exploit-db.com/exploits/25978; reference:cve,2024-12847; classtype:attempted-admin; sid:2034576; rev:3; metadata:affected_product Netgear_Router, attack_target Networking_Equipment, created_at 2021_12_02, deployment Perimeter, confidence High, signature_severity Major, tag Exploit, updated_at 2021_12_03, reviewed_at 2024_06_26, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Hikvision IP Camera RCE Attempt (CVE-2021-36260)"; flow:established,to_server; http.method; content:"PUT"; http.uri; content:"/SDK/webLanguage"; bsize:16; fast_pattern; http.request_body; content:"|3c|language|3e|"; nocase; pcre:"/(?:[\x60\x3b\x7c]|%60|%3b|%7c|%26|(?:[\x3c\x3e\x24]|%3c|%3e|%24)(?:\x28|%28))/R"; reference:url,github.com/mcw0/PoC/blob/master/CVE-2021-36260.py; reference:url,watchfulip.github.io/2021/09/18/Hikvision-IP-Camera-Unauthenticated-RCE.html; reference:url,www.fortinet.com/blog/threat-research/mirai-based-botnet-moobot-targets-hikvision-vulnerability; reference:cve,2021-36260; classtype:attempted-admin; sid:2034630; rev:2; metadata:affected_product IP_Camera, attack_target Networking_Equipment, created_at 2021_12_08, cve CVE_2021_36260, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag CISA_KEV, updated_at 2021_12_08;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-Link TL-WR840N EU v5 RCE Attempt (CVE-2021-41653)"; flow:established,to_server; http.request_line; content:"POST /cgi?2"; startswith; fast_pattern; http.request_body; content:"|5b|IPPING|5f|DIAG|23|"; nocase; content:"host="; distance:0; nocase; pcre:"/^(?:[\x60\x3b\x7c]|%60|%3b|%7c|%26|(?:[\x3c\x3e\x24]|%3c|%3e|%24)(?:\x28|%28))/R"; reference:url,k4m1ll0.com/cve-2021-41653.html; reference:url,www.fortinet.com/blog/threat-research/manga-aka-dark-mirai-based-campaign-targets-new-tp-link-router-rce-vulnerability; reference:cve,2021-41653; classtype:attempted-admin; sid:2034677; rev:2; metadata:attack_target Networking_Equipment, created_at 2021_12_11, cve CVE_2021_41653, deployment Perimeter, performance_impact Low, confidence High, signature_severity Major, updated_at 2021_12_11;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Netgear R6260 Mini_httpd Buffer Overflow Attempt - Possible RCE (CVE-2021-34979)"; flow:established,to_server; http.header; content:"SOAPAction|3a 20|"; content:"urn:NETGEAR-ROUTER:service:"; within:30; fast_pattern; content:!"|0d 0a|"; within:131; pcre:"/^SOAPAction\x3a\x20\x22?urn\x3aNETGEAR-ROUTER\x3aservice\x3a.{128,}(?!:\d#)/Hm"; http.request_body; content:"|3c 3f|xml"; startswith; reference:url,nstarke.github.io/netgear/nday/2022/03/13/reverse-engineering-a-netgear-nday.html; reference:cve,2021-34979; classtype:trojan-activity; sid:2035446; rev:1; metadata:attack_target Networking_Equipment, created_at 2022_03_14, cve CVE_2021_34979, deployment Perimeter, deployment Internal, confidence Medium, signature_severity Major, updated_at 2022_03_14;)

# source: PublicRules/et_rules/emerging-exploit.rules
#alert dns $EXTERNAL_NET any -> any any (msg:"ET EXPLOIT Possible DNS BIND TSIG Denial of Service Attempt (CVE-2020-8617)"; content:"|00|"; distance:0; byte_extract:1,1,rec_name,relative; content:"|00 00 fa 00 ff|"; distance:rec_name; within:5; fast_pattern; content:"|00 10 00 00|"; endswith; reference:cve,2020-8617; classtype:denial-of-service; sid:2030221; rev:2; metadata:attack_target DNS_Server, created_at 2020_05_26, deployment Datacenter, performance_impact Low, confidence Medium, signature_severity Major, updated_at 2022_03_24;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT D-Link Router DNS Changer Exploit Attempt"; flow:established,to_server; http.uri; content:"/dnscfg.cgi?dnsPrimary="; fast_pattern; content:"&dnsSecondary="; distance:0; content:"&dnsDynamic=0&dnsRefresh=1"; endswith; reference:url,csirt.bank.gov.ua/en/news/44; classtype:attempted-admin; sid:2027906; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_08_23, deployment Perimeter, performance_impact Moderate, signature_severity Major, updated_at 2022_03_24, reviewed_at 2024_04_22;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT TOTOLINK Router DNS Changer Exploit Attempt"; flow:established,to_server; http.uri; content:"/boafrm/formbasetcpipsetup?dnsmode=dnsmanual&dns1="; fast_pattern; content:"&dns2="; distance:0; content:"&dns3="; distance:0; content:"&dnsrefresh=1"; endswith; reference:url,csirt.bank.gov.ua/en/news/44; classtype:attempted-admin; sid:2027910; rev:4; metadata:attack_target Client_Endpoint, created_at 2019_08_23, deployment Perimeter, performance_impact Moderate, signature_severity Major, updated_at 2022_03_24, reviewed_at 2024_04_22;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET EXPLOIT NetGear R6700v3 upnpd Buffer Overflow Inbound (CVE-2022-27643)"; flow:to_server,established; http.method; content:"POST"; http.header; content:"SOAPAction|3a|"; nocase; content:"urn:NETGEARROUTER:service:ParentalControl:1#Authenticate"; fast_pattern; nocase; pcre:"/^SOAPAction\x3a\s?urn\x3aNETGEARROUTER\x3aservice\x3aParentalControl\x3a1#Authenticate/Hmi"; http.request_body; content:"<NewMACAddress>"; nocase; pcre:"/^[^<]{30,}<\/NewMACAddress>/Ri"; reference:url,blog.relyze.com/2022/03/cve-2022-27643-netgear-r6700v3-upnpd.html; reference:cve,2022-27643; classtype:attempted-admin; sid:2035717; rev:1; metadata:attack_target Networking_Equipment, created_at 2022_04_03, cve CVE_2022_27643, deployment Perimeter, deployment Internal, confidence High, signature_severity Major, updated_at 2022_04_03;)

# source: PublicRules/et_rules/emerging-exploit.rules
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible MHTML CVE-2012-0158 Vulnerable CLSID+b64 Office Doc Magic 1"; flow:established; file_data; content:"bdd1f04b-858b-11d1-b16a-00c0f0283628"; nocase; content:"0M8R4KGxGu"; reference:url,www.antiy.net/wp-content/uploads/The-Latest-APT-Attack-by-Exploiting-CVE2012-0158-Vulnerability.pdf; reference:url,contagiodump.blogspot.com/2013/09/sandbox-miming-cve-2012-0158-in-mhtml.html; classtype:trojan-activity; sid:2017409; rev:4; metadata:created_at 2013_09_03, confidence Medium, signature_severity Major, tag CISA_KEV, updated_at 2022_07_01;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible MHTML CVE-2012-0158 Vulnerable CLSID+b64 Office Doc Magic 2"; flow:established; file_data; content:"996BF5E0-8044-4650-ADEB-0B013914E99C"; nocase; content:"0M8R4KGxGu"; reference:url,www.antiy.net/wp-content/uploads/The-Latest-APT-Attack-by-Exploiting-CVE2012-0158-Vulnerability.pdf; reference:url,contagiodump.blogspot.com/2013/09/sandbox-miming-cve-2012-0158-in-mhtml.html; classtype:trojan-activity; sid:2017410; rev:4; metadata:created_at 2013_09_03, confidence Medium, signature_severity Major, tag CISA_KEV, updated_at 2022_07_01;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible MHTML CVE-2012-0158 Vulnerable CLSID+b64 Office Doc Magic 3"; flow:established; file_data; content:"C74190B6-8589-11d1-B16A-00C0F0283628"; nocase; content:"0M8R4KGxGu"; reference:url,www.antiy.net/wp-content/uploads/The-Latest-APT-Attack-by-Exploiting-CVE2012-0158-Vulnerability.pdf; reference:url,contagiodump.blogspot.com/2013/09/sandbox-miming-cve-2012-0158-in-mhtml.html; classtype:trojan-activity; sid:2017411; rev:4; metadata:created_at 2013_09_03, confidence Medium, signature_severity Major, tag CISA_KEV, updated_at 2022_07_01;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible Metasploit Java CVE-2013-2465 Class Name Sub Algo"; flow:established,from_server; flowbits:isset,ET.http.javaclient; file_data; content:".classPK"; content:"$"; distance:-21; within:1; content:".classPK"; distance:0; content:"$"; distance:-21; within:1; pcre:"/\b(?P<xps>[a-zA-Z]{7})\.classPK.+?\b(?P=xps)\$[a-zA-Z]{12}\.classPK.+?\b(?P=xps)\$[a-zA-Z]{12}\.classPK/s"; reference:cve,2013-2465; reference:url,seclists.org/fulldisclosure/2013/Aug/134; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/browser/java_storeimagearray.rb; classtype:attempted-user; sid:2017568; rev:5; metadata:affected_product Any, attack_target Client_and_Server, created_at 2013_10_08, deployment Perimeter, deployment Internet, deployment Internal, deployment Datacenter, confidence Medium, signature_severity Critical, tag Metasploit, tag CISA_KEV, updated_at 2022_07_01;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Metasploit Exploit Specific Function Naming"; flow:established,to_client; file_data; content:"function putPayload("; nocase; fast_pattern; classtype:attempted-user; sid:2017510; rev:4; metadata:affected_product Any, attack_target Client_and_Server, created_at 2013_09_24, deployment Perimeter, deployment Internet, deployment Internal, deployment Datacenter, signature_severity Critical, tag Metasploit, updated_at 2022_07_04;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible Internet Explorer Use-After-Free Inbound (CVE-2012-4792)"; flow:established,from_server; file_data; content:"urn|3a|schemas-microsoft-com|3a|time"; nocase; content:"#default#time2"; content:"<t|3a|ANIMATECOLOR"; nocase; fast_pattern; content:"CollectGarbage"; nocase; content:"try"; distance:0; nocase; content:".values"; distance:0; nocase; pcre:"/^[\r\n\s\+]*?=.+?\}[\r\n\s]*?catch/Rsi"; reference:cve,2012-4792; reference:url,blog.exodusintel.com/2013/01/02/happy-new-year-analysis-of-cve-2012-4792/; classtype:attempted-user; sid:2016138; rev:7; metadata:created_at 2013_01_03, confidence Low, signature_severity Major, tag CISA_KEV, updated_at 2022_07_12;)

#alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2013-0156 Ruby On Rails XML POST to Disallowed Type SYMBOL"; flow:established,to_server; http.method; content:"POST"; http.request_body; content:"|20|type="; nocase; fast_pattern; content:"symbol"; distance:0; nocase; pcre:"/<[^>]*\stype\s*=\s*[\x22\x27]symbol[\x22\x27]/i"; http.content_type; pcre:"/^(?:application\/(?:x-)?|text\/)xml/"; reference:url,groups.google.com/forum/?hl=en&fromgroups=#!topic/rubyonrails-security/61bkgvnSGTQ; classtype:web-application-activity; sid:2016176; rev:7; metadata:created_at 2013_01_09, confidence Medium, signature_severity Major, updated_at 2022_07_14;)

#alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2013-0156 Ruby On Rails XML POST to Disallowed Type YAML"; flow:established,to_server; http.method; content:"POST"; http.request_body; content:"|20|type="; nocase; fast_pattern; content:"yaml"; distance:0; nocase; pcre:"/<[^>]*\stype\s*=\s*[\x22\x27]yaml[\x22\x27]/i"; http.content_type; pcre:"/^(?:application\/(?:x-)?|text\/)xml/"; reference:url,groups.google.com/forum/?hl=en&fromgroups=#!topic/rubyonrails-security/61bkgvnSGTQ; classtype:web-application-attack; sid:2016175; rev:7; metadata:created_at 2013_01_09, confidence Medium, signature_severity Major, updated_at 2022_07_14;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible Java CVE-2013-1488 java.sql.Drivers Service Object in JAR"; flow:established,from_server; flowbits:isset,ET.http.javaclient; file_data; content:"META-INF/services/java.sql.Drivers"; fast_pattern; content:"META-INF/services/java.lang.Object"; reference:cve,2013-1488; reference:url,www.contextis.com/research/blog/java-pwn2own/; reference:url,www.rapid7.com/db/modules/exploit/multi/browser/java_jre17_driver_manager; classtype:attempted-user; sid:2017557; rev:6; metadata:created_at 2013_10_04, confidence Medium, signature_severity Major, updated_at 2022_07_14;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET EXPLOIT Javadoc API Redirect CVE-2013-1571"; flow:established,to_server; http.method; content:"GET"; nocase; http.referer; content:"?//"; fast_pattern; pcre:"/\/(?:(?:index|toc)\.html?)?\?\/\//i"; reference:cve,2013-1571; classtype:bad-unknown; sid:2017037; rev:6; metadata:created_at 2013_06_20, signature_severity Major, updated_at 2022_07_14;)

alert http any any -> any [5555,7547] (msg:"ET EXPLOIT Eir D1000 Modem CWMP Exploit RCE"; flow:to_server,established; http.header; content:"urn|3a|dslforum-org|3a|service|3a|Time|3a|1#SetNTPServers"; nocase; fast_pattern; http.request_body; content:"NewNTPServer"; content:">"; distance:0; within:5; pcre:"/^.{0,10}[\x3b\x0a\x26\x60\x7c\x24]/R"; reference:url,devicereversing.wordpress.com/2016/11/07/eirs-d1000-modem-is-wide-open-to-being-hacked/; reference:md5,a19d5b596992407796a33c5e15489934; classtype:trojan-activity; sid:2023548; rev:6; metadata:affected_product Eir_D1000_Modem, attack_target Networking_Equipment, created_at 2016_11_28, deployment Perimeter, confidence Medium, signature_severity Major, updated_at 2022_08_09;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET EXPLOIT Xiongmai/HiSilicon DVR - RTSP Buffer Overflow Attempt - CVE-2022-26259"; flow:established,to_server; http.method; content:"OPTIONS"; http.header; content:"CSeq|3a 20 3b|"; fast_pattern; content:!"|0d 0a|"; within:100; reference:url,vulncheck.com/blog/xiongmai-iot-exploitation; reference:url,blog.ret2.me/post/2022-01-26-exploiting-xiongmai-dvrs/; reference:cve,2022-26259; classtype:attempted-admin; sid:2041650; rev:1; metadata:affected_product DVR, attack_target IoT, created_at 2022_12_02, cve CVE_2022_26259, deployment Perimeter, confidence High, signature_severity Major, updated_at 2022_12_02;)

# source: PublicRules/et_rules/emerging-exploit.rules
#alert tcp $EXTERNAL_NET any -> $HOME_NET [25,465,587] (msg:"ET EXPLOIT CVE-2015-0235 Exim Buffer Overflow Attempt (HELO)"; flow:to_server,established; content:"HELO "; nocase; content:!"|0a|"; within:1024; pcre:"/^\s*?\d[\d\x2e]{255}/R"; reference:url,openwall.com/lists/oss-security/2015/01/27/9; classtype:attempted-admin; sid:2020325; rev:3; metadata:created_at 2015_01_28, confidence High, signature_severity Major, updated_at 2023_01_26;)

#alert tcp $EXTERNAL_NET any -> $HOME_NET [25,465,587] (msg:"ET EXPLOIT CVE-2015-0235 Exim Buffer Overflow Attempt (EHLO)"; flow:to_server,established; content:"EHLO "; nocase; content:!"|0a|"; within:1024; pcre:"/^\s*?\d[\d\x2e]{255}/R"; reference:url,openwall.com/lists/oss-security/2015/01/27/9; classtype:attempted-admin; sid:2020326; rev:5; metadata:created_at 2015_01_28, confidence High, signature_severity Major, updated_at 2023_01_26;)

alert http any any -> $HOME_NET any (msg:"ET EXPLOIT D-Link webupg Remote Code Execution Attempt Inbound (CVE 2021-46441, 2021-46442)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/cgi-bin/webupg"; fast_pattern; bsize:15; http.referer; content:"autoupgrade.asp"; endswith; http.request_body; content:"name|3d|shell&key|3d|twmode&cmd|3d|"; reference:url,github.com/tgp-top/D-Link-DIR-825; reference:cve,2021-46441; reference:cve,2021-46442; classtype:attempted-admin; sid:2044009; rev:1; metadata:affected_product IoT, attack_target Networking_Equipment, created_at 2023_01_27, cve CVE_2021_46441, deployment Perimeter, deployment Internal, deployment SSLDecrypt, performance_impact Low, confidence High, signature_severity Major, updated_at 2023_01_27, reviewed_at 2024_09_30, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET EXPLOIT Tenda OS Command Injection (CVE-2020-10987) (GET)"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"goform/setUsbUnload"; nocase; fast_pattern; content:"deviceName="; nocase; distance:0; content:"|3b|"; distance:0; pcre:"/deviceName=[^&$]+\x3b/"; reference:url,cybersecurity.att.com/blogs/labs-research/att-alien-labs-finds-new-golang-malwarebotenago-targeting-millions-of-routers-and-iot-devices-with-more-than-30-exploits; reference:cve,2020-10987; classtype:attempted-admin; sid:2034489; rev:3; metadata:attack_target Server, created_at 2021_11_17, cve CVE_2020_10987, deployment Perimeter, deployment Internal, confidence High, signature_severity Major, tag Exploit, tag CISA_KEV, updated_at 2023_02_04, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $HOME_NET any -> any 80 (msg:"ET EXPLOIT Possible Command Injection via User-Agent (PwnAgent) - CVE-2023-24749, CVE-2022-47208"; flow:established,to_server; http.method; content:"GET"; http.user_agent; content:"|22 3b|"; content:"|3b 22|"; endswith; fast_pattern; reference:url,mahaloz.re/2023/02/25/pwnagent-netgear.html; reference:url,www.synacktiv.com/en/publications/cool-vulns-dont-live-long-netgear-and-pwn2own.html; reference:cve,2023-24749; reference:cve,2022-47208; classtype:attempted-admin; sid:2045636; rev:1; metadata:affected_product Netgear_Router, attack_target Networking_Equipment, created_at 2023_05_11, cve CVE_2023_24749_CVE_2022_47208, deployment Perimeter, deployment Internal, performance_impact Low, confidence Low, signature_severity Major, updated_at 2023_05_11, mitre_tactic_id TA0008, mitre_tactic_name Lateral_Movement, mitre_technique_id T1210, mitre_technique_name Exploitation_Of_Remote_Services; target:dest_ip;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Tenda G103 Command Injection Attempt (CVE-2023-27076)"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/cgi-bin/luci?language="; fast_pattern; startswith; pcre:"/(?:(wget|curl))/R"; reference:url,unit42.paloaltonetworks.com/mirai-variant-iz1h9/; reference:cve,2023-27076; classtype:attempted-admin; sid:2048547; rev:1; metadata:attack_target IoT, created_at 2023_10_12, cve CVE_2023_27076, deployment Perimeter, performance_impact Low, confidence Medium, signature_severity Major, updated_at 2023_10_12, reviewed_at 2023_10_12, mitre_tactic_id TA0008, mitre_tactic_name Lateral_Movement, mitre_technique_id T1210, mitre_technique_name Exploitation_Of_Remote_Services; target:dest_ip;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert tcp any any -> $HOME_NET 23 (msg:"ET EXPLOIT Possible Uniview IPC2322lb updatecpld Restricted Shell Bypass Attempt"; flow:established,to_server; content:"User|40 2f|"; content:">updatecpld "; nocase; within:30; fast_pattern; reference:url,ssd-disclosure.com/ssd-advisory-uniview-ipc2322lb-auth-bypass-and-cli-escape/; classtype:bad-unknown; sid:2051785; rev:1; metadata:affected_product IoT, attack_target IoT, tls_state plaintext, created_at 2024_03_25, deployment Perimeter, confidence Low, signature_severity Major, updated_at 2024_03_25; target:dest_ip;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT D-LINK Router DIR-645 / DIR-815 RCE (CVE-2014-100005)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/diagnostic.php"; fast_pattern; endswith; http.request_body; content:"act=ping"; content:"dst="; pcre:"/^(?:\x3b|\x0a|\x26|\x60|\x7C|\x24)/R"; reference:cve,2014-100005; reference:url,raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/linux/http/dlink_diagnostic_exec_noauth.rb; classtype:attempted-admin; sid:2052885; rev:2; metadata:affected_product D_Link, attack_target Networking_Equipment, tls_state TLSDecrypt, created_at 2024_05_24, cve CVE_2014_100005, deployment Perimeter, confidence High, signature_severity Major, tag CISA_KEV, updated_at 2024_05_30, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> any any (msg:"ET EXPLOIT Zhone ZNID GPON 2426A < S3.0.501 RCE (CVE-2014-9118) M1"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/zhnping.cmd?"; fast_pattern; content:"test=ping"; content:"sessionKey="; content:"ipAddr="; pcre:"/^[a-z0-9\.]+(?:[\x60\x3b\x7c\x26]|%60|%3b|%7c|%26|(?:[\x3c\x3e\x24]|%3c|%3e|%24)(?:\x28|%28))/Ri"; reference:url,www.exploit-db.com/exploits/38453; reference:url,cybersecurity.att.com/blogs/labs-research/rapidly-evolving-iot-malware-enemybot-now-targeting-content-management-system-servers; reference:cve,2014-9118; classtype:attempted-admin; sid:2036749; rev:2; metadata:attack_target Server, created_at 2022_06_02, cve CVE_2014_9118, deployment Perimeter, deployment Internal, confidence High, signature_severity Major, tag Exploit, updated_at 2024_06_23, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert http any any -> any any (msg:"ET EXPLOIT Zhone ZNID GPON 2426A < S3.0.501 RCE (CVE-2014-9118) M2"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/zhnping.cmd?"; fast_pattern; content:"test=traceroute"; content:"sessionKey="; content:"ipAddr="; pcre:"/^[a-z0-9\.]+(?:[\x60\x3b\x7c\x26]|%60|%3b|%7c|%26|(?:[\x3c\x3e\x24]|%3c|%3e|%24)(?:\x28|%28))/Ri"; reference:url,www.exploit-db.com/exploits/38453; reference:url,cybersecurity.att.com/blogs/labs-research/rapidly-evolving-iot-malware-enemybot-now-targeting-content-management-system-servers; reference:cve,2014-9118; classtype:attempted-admin; sid:2036750; rev:2; metadata:attack_target Server, created_at 2022_06_02, cve CVE_2014_9118, deployment Perimeter, deployment Internal, confidence High, signature_severity Major, tag Exploit, updated_at 2024_06_23, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

# source: PublicRules/et_rules/emerging-exploit.rules
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT RealVNC Authentication Bypass Attempt"; flowbits:isset,BSvnc.auth.offered; flow:established; dsize:1; content:"|01|"; depth:1; flowbits:set,BSvnc.null.auth.sent; reference:url,secunia.com/advisories/20107/; reference:url,archives.neohapsis.com/archives/fulldisclosure/2006-05/0356.html; reference:cve,2006-2369; classtype:attempted-admin; sid:2002916; rev:7; metadata:created_at 2010_07_30, deployment Perimeter, deployment Internal, confidence High, signature_severity Major, updated_at 2024_11_26, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

#alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET EXPLOIT RealVNC Server Authentication Bypass Successful"; flowbits:isset,BSvnc.null.auth.sent; flow:established; dsize:4; content:"|00 00 00 00|"; depth:4; flowbits:unset,BSis.vnc.setup; flowbits:unset,BSvnc.auth.offered; reference:url,secunia.com/advisories/20107/; reference:url,archives.neohapsis.com/archives/fulldisclosure/2006-05/0356.html; reference:cve,2006-2369; classtype:successful-admin; sid:2002917; rev:7; metadata:created_at 2010_07_30, deployment Perimeter, deployment Internal, confidence High, signature_severity Major, updated_at 2024_11_26, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Linksys WRT54g Authentication Bypass Attempt"; flow:established,to_server; content:"/Security.tri"; http_uri; nocase; content:"SecurityMode=0"; nocase; reference:url,secunia.com/advisories/21372/; classtype:attempted-admin; sid:2003072; rev:6; metadata:created_at 2010_07_30, deployment Perimeter, deployment Internal, confidence High, signature_severity Major, updated_at 2024_11_26, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible Foxit PDF Reader Authentication Bypass Attempt"; flow:established,to_client; file_data; content:"%PDF-"; within:5; content:"Type/Action"; distance:0; nocase; content:"Launch"; nocase; within:40; content:"NewWindow true"; nocase; distance:0; pcre:"/Type\x2FAction.+Launch.+\x28\x2F[a-z]\x2F[a-z].+NewWindow\x20true/si"; reference:url,www.coresecurity.com/content/foxit-reader-vulnerabilities#lref.4; reference:cve,2009-0836; classtype:attempted-user; sid:2010878; rev:8; metadata:created_at 2010_07_30, deployment Perimeter, deployment Internal, confidence High, signature_severity Major, updated_at 2024_11_26, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET EXPLOIT Outbound GPON Authentication Bypass Attempt (CVE-2018-10561)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"?images/"; pcre:"/(?:\/GponForm\/diag_FORM\?images\/|\.html\?images\/)/i"; http.request_body; content:"XWebPageName=diag&diag"; depth:22; fast_pattern; reference:url,www.vpnmentor.com/blog/critical-vulnerability-gpon-router/; classtype:attempted-admin; sid:2027063; rev:3; metadata:created_at 2019_03_06, cve CVE_2018_10561, deployment Perimeter, deployment Internal, confidence High, signature_severity Major, tag CISA_KEV, updated_at 2024_11_26, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-exploit.rules
alert tcp any any -> $HOME_NET [23,2323] (msg:"ET EXPLOIT Actiontec C1000A backdoor account M1"; flow:established,to_server; content:"QwestM0dem"; fast_pattern; classtype:attempted-admin; sid:2025080; rev:3; metadata:affected_product Linux, attack_target IoT, created_at 2017_11_28, deployment Perimeter, malware_family Mirai, performance_impact Low, signature_severity Major, updated_at 2025_01_03;)

# source: PublicRules/et_rules/emerging-hunting.rules
alert http $EXTERNAL_NET any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET HUNTING Possible UPnP UUID Overflow Exploit Attempt from External Host - SUBSCRIBE/UNSUBSCRIBE"; flow:established,to_server; http.method; content:"SUBSCRIBE"; http.header; content:"UUID|3a 20|"; fast_pattern; pcre:"/^[^\r\n]{100,}/R"; classtype:unknown; sid:2034495; rev:1; metadata:created_at 2021_11_18, confidence Medium, signature_severity Major, updated_at 2021_11_18;)

# source: PublicRules/et_rules/emerging-hunting.rules
alert http [$HOME_NET,$HTTP_SERVERS] any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET HUNTING Possible UPnP UUID Overflow Exploit Attempt from Internal Host - SUBSCRIBE/UNSUBSCRIBE"; flow:established,to_server; http.method; content:"SUBSCRIBE"; http.header; content:"UUID|3a 20|"; fast_pattern; pcre:"/^[^\r\n]{100,}/R"; classtype:unknown; sid:2034496; rev:1; metadata:created_at 2021_11_18, confidence Medium, signature_severity Major, updated_at 2021_11_18;)

# source: PublicRules/et_rules/emerging-hunting.rules
alert http $EXTERNAL_NET any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET HUNTING Possible UPnP UUID Overflow Exploit Attempt from External Host - NOTIFY"; flow:established,to_server; http.method; content:"NOTIFY"; http.header; content:"UUID|3a 20|"; fast_pattern; pcre:"/^[^\r\n]{100,}/R"; classtype:unknown; sid:2034497; rev:1; metadata:created_at 2021_11_18, confidence Medium, signature_severity Major, updated_at 2021_11_18;)

# source: PublicRules/et_rules/emerging-hunting.rules
alert http [$HOME_NET,$HTTP_SERVERS] any -> [$HOME_NET,$HTTP_SERVERS] any (msg:"ET HUNTING Possible UPnP UUID Overflow Exploit Attempt from Internal Host - NOTIFY"; flow:established,to_server; http.method; content:"NOTIFY"; http.header; content:"UUID|3a 20|"; fast_pattern; pcre:"/^[^\r\n]{100,}/R"; classtype:unknown; sid:2034498; rev:1; metadata:created_at 2021_11_18, confidence Medium, signature_severity Major, updated_at 2021_11_18;)

# source: PublicRules/et_rules/emerging-hunting.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323,3323,4323] (msg:"ET HUNTING SUSPICIOUS Path to BusyBox"; flow:established,to_server; content:"/bin/busybox"; flowbits:set,ET.telnet.busybox; threshold: type limit, count 1, track by_src, seconds 30; reference:url,lists.emergingthreats.net/pipermail/emerging-sigs/2016-August/027524.html; classtype:suspicious-filename-detect; sid:2023016; rev:2; metadata:attack_target Server, created_at 2016_08_08, deployment Datacenter, performance_impact Low, confidence Medium, signature_severity Major, updated_at 2022_04_18;)

# source: PublicRules/et_rules/emerging-info.rules
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Java Request to DynDNS Pro Dynamic DNS Domain"; flow:to_server,established; http.user_agent; content:"Java/1."; http.host; pcre:"/\.(?:i(?:s(?:-(?:a(?:-(?:(?:(?:h(?:ard-work|unt)e|financialadviso)r|d(?:e(?:mocrat|signer)|octor)|t(?:e(?:acher|chie)|herapist)|r(?:epublican|ockstar)|n(?:ascarfan|urse)|anarchist|musician)\.com|c(?:(?:(?:ubicle-sla|onservati)ve|pa)\.com|a(?:ndidate\.org|terer\.com)|hef\.(?:com|net|org)|elticsfan\.org)|l(?:i(?:ber(?:tarian|al)\.com|nux-user\.org)|(?:a(?:ndscap|wy)er|lama)\.com)|p(?:(?:ersonaltrain|hotograph|lay)er\.com|a(?:inter\.com|tsfan\.org))|b(?:(?:(?:ookkeep|logg)er|ulls-fan)\.com|ruinsfan\.org)|s(?:o(?:cialist\.com|xfan\.org)|tudent\.com)|g(?:eek\.(?:com|net|org)|(?:reen|uru)\.com)|knight\.org)|n-(?:a(?:c(?:t(?:ress|or)|countant)|(?:narch|rt)ist)|en(?:tertain|gine)er)\.com)|(?:into-(?:(?:car(?:toon)?|game)s|anime)|(?:(?:not-)?certifie|with-theban)d|uberleet|gone)\.com|(?:very-(?:(?:goo|ba)d|sweet|evil|nice)|found)\.org|s(?:aved\.org|lick\.com)|l(?:eet\.com|ost\.org)|by\.us)|a-(?:geek\.(?:com|net|org)|hockeynut\.com)|t(?:eingeek|mein)\.de|smarterthanyou\.com)|n-the-band\.net|amallama\.com)|f(?:rom-(?:(?:i[adln]|w[aivy]|o[hkr]|[hr]i|d[ce]|k[sy]|p[ar]|s[cd]|t[nx]|v[at]|fl|ga|ut)\.com|m(?:[adinost]\.com|e\.org)|n(?:[cdehjmv]\.com|y\.net)|a(?:[klr]\.com|z\.net)|c(?:[at]\.com|o\.net)|la\.net)|or(?:-(?:(?:(?:mor|som|th)e|better)\.biz|our\.info)|got\.h(?:er|is)\.name)|uettertdasnetz\.de|tpaccess\.cc)|s(?:e(?:l(?:ls(?:-(?:for-(?:less|u)\.com|it\.net)|yourhome\.org)|fip\.(?:info|biz|com|net|org))|rve(?:bbs\.(?:com|net|org)|ftp\.(?:net|org)|game\.org))|(?:aves-the-whales|pace-to-rent|imple-url)\.com|crapp(?:er-site\.net|ing\.cc)|tuff-4-sale\.(?:org|us)|hacknet\.nu)|d(?:o(?:es(?:ntexist\.(?:com|org)|-it\.net)|ntexist\.(?:com|net|org)|omdns\.(?:com|org))|yn(?:a(?:lias\.(?:com|net|org)|thome\.net)|-o-saur\.com|dns\.ws)|ns(?:alias\.(?:com|net|org)|dojo\.(?:com|net|org))|vrdns\.org)|h(?:o(?:me(?:linux\.(?:com|net|org)|unix\.(?:com|net|org)|(?:\.dyn)?dns\.org|ftp\.(?:net|org)|ip\.net)|bby-site\.(?:com|org))|ere-for-more\.info|am-radio-op\.net)|b(?:log(?:dns\.(?:com|net|org)|site\.org)|(?:uyshouses|roke-it)\.net|arrel?l-of-knowledge\.info|oldlygoingnowhere\.org|etter-than\.tv)|g(?:o(?:tdns\.(?:com|org)|\.dyndns\.org)|ame-(?:server\.cc|host\.org)|et(?:myip\.com|s-it\.net)|roks-th(?:is|e)\.info)|e(?:st-(?:(?:a-la-ma(?:is|si)|le-patr)on|mon-blogueur)\.com|ndof(?:internet\.(?:net|org)|theinternet\.org))|l(?:e(?:btimnetz|itungsen)\.de|ikes(?:candy|-pie)\.com|and-4-sale\.us)|m(?:i(?:sconfused\.org|ne\.nu)|yp(?:hotos\.cc|ets\.ws)|erseine\.nu)|w(?:ebhop\.(?:info|biz|net|org)|ritesthisblog\.com|orse-than\.tv)|t(?:eaches-yoga\.com|raeumtgerade\.de|hruhere\.net)|k(?:icks-ass\.(?:net|org)|nowsitall\.info)|o(?:ffice-on-the\.net|n-the-web\.tv)|(?:neat-url|cechire)\.com|podzone\.(?:net|org)|at-band-camp\.net|readmyblog\.org)(\x3a\d{1,5})?$/"; classtype:bad-unknown; sid:2016580; rev:6; metadata:created_at 2013_03_15, signature_severity Informational, updated_at 2020_09_03;)

# source: PublicRules/et_rules/emerging-info.rules
alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.doomdns .org Domain"; dns.query; content:".doomdns.org"; fast_pattern; nocase; endswith; reference:url,help.dyn.com/list-of-dyn-dns-pro-remote-access-domain-names/; classtype:bad-unknown; sid:2042581; rev:2; metadata:attack_target Client_and_Server, created_at 2022_12_11, deployment Perimeter, performance_impact Low, confidence High, signature_severity Informational, updated_at 2023_03_02, mitre_tactic_id TA0011, mitre_tactic_name Command_And_Control, mitre_technique_id T1568, mitre_technique_name Dynamic_Resolution;)

# source: PublicRules/et_rules/emerging-info.rules
alert dns $HOME_NET any -> any any (msg:"ET INFO DYNAMIC_DNS Query to a *.doomdns .com Domain"; dns.query; content:".doomdns.com"; fast_pattern; nocase; endswith; reference:url,help.dyn.com/list-of-dyn-dns-pro-remote-access-domain-names/; classtype:bad-unknown; sid:2042695; rev:2; metadata:attack_target Client_and_Server, created_at 2022_12_13, deployment Perimeter, performance_impact Low, confidence High, signature_severity Informational, updated_at 2023_03_02, mitre_tactic_id TA0011, mitre_tactic_name Command_And_Control, mitre_technique_id T1568, mitre_technique_name Dynamic_Resolution;)

# source: PublicRules/et_rules/emerging-info.rules
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.doomdns .com Domain"; flow:established,to_server; http.host; content:".doomdns.com"; endswith; reference:url,help.dyn.com/list-of-dyn-dns-pro-remote-access-domain-names/; classtype:bad-unknown; sid:2042696; rev:2; metadata:attack_target Client_and_Server, created_at 2022_12_13, deployment Perimeter, performance_impact Low, confidence High, signature_severity Informational, updated_at 2023_03_02, mitre_tactic_id TA0011, mitre_tactic_name Command_And_Control, mitre_technique_id T1568, mitre_technique_name Dynamic_Resolution;)

# source: PublicRules/et_rules/emerging-info.rules
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO DYNAMIC_DNS HTTP Request to a *.doomdns .org Domain"; flow:established,to_server; http.host; content:".doomdns.org"; endswith; reference:url,help.dyn.com/list-of-dyn-dns-pro-remote-access-domain-names/; classtype:bad-unknown; sid:2042582; rev:2; metadata:attack_target Client_and_Server, created_at 2022_12_11, deployment Perimeter, performance_impact Low, confidence High, signature_severity Informational, updated_at 2023_03_02, mitre_tactic_id TA0011, mitre_tactic_name Command_And_Control, mitre_technique_id T1568, mitre_technique_name Dynamic_Resolution;)

# source: PublicRules/et_rules/emerging-info.rules
alert udp $HOME_NET 1900 -> any any (msg:"ET INFO UPnP Discovery Search Response - CVE-2012-5958 and CVE-2012-5959 Vulnerable UPnP device M2"; content:"Intel SDK for UPnP devices"; pcre:"/^Server\x3a[^\r\n]*Intel SDK for UPnP devices/mi"; reference:url,community.rapid7.com/community/infosec/blog/2013/01/29/security-flaws-in-universal-plug-and-play-unplug-dont-play; reference:url,upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v1.1.pdf; reference:cve,2012-5958; reference:cve,2012-5959; classtype:bad-unknown; sid:2016303; rev:5; metadata:created_at 2013_01_30, cve CVE_2012_5958, deployment Perimeter, confidence High, signature_severity Minor, updated_at 2023_05_02; target:src_ip;)

# source: PublicRules/et_rules/emerging-info.rules
alert udp $HOME_NET 1900 -> any any (msg:"ET INFO UPnP Discovery Search Response - CVE-2012-5958 and CVE-2012-5959 Vulnerable UPnP device M3"; content:"Portable SDK for UPnP devices"; pcre:"/^Server\x3a[^\r\n]*Portable SDK for UPnP devices(\/?\s*$|\/1\.([0-5]\..|8\.0.|(6\.[0-9]|6\.1[0-7])))/m"; reference:url,community.rapid7.com/community/infosec/blog/2013/01/29/security-flaws-in-universal-plug-and-play-unplug-dont-play; reference:url,upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v1.1.pdf; reference:cve,2012-5958; reference:cve,2012-5959; classtype:bad-unknown; sid:2016304; rev:3; metadata:created_at 2013_01_30, cve CVE_2012_5958, deployment Perimeter, confidence High, signature_severity Minor, updated_at 2023_05_02; target:src_ip;)

# source: PublicRules/et_rules/emerging-info.rules
alert udp $HOME_NET 1900 -> any any (msg:"ET INFO UPnP Discovery Search Response - CVE-2012-5958 and CVE-2012-5959 Vulnerable UPnP device M1"; content:"miniupnpd/1."; fast_pattern; pcre:"/^Server\x3a[^\r\n]*miniupnpd\/1\.[0-3]/mi"; reference:url,community.rapid7.com/community/infosec/blog/2013/01/29/security-flaws-in-universal-plug-and-play-unplug-dont-play; reference:url,upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v1.1.pdf; reference:cve,2013-0229; classtype:bad-unknown; sid:2016302; rev:7; metadata:created_at 2013_01_30, cve CVE_2013_0229, deployment Perimeter, confidence High, signature_severity Minor, updated_at 2023_05_02; target:src_ip;)

# source: PublicRules/et_rules/emerging-info.rules
alert tls $HOME_NET any -> $EXTERNAL_NET any (msg:"ET INFO Observed DNS over HTTPS Domain in TLS SNI (karimdns .com)"; flow:established,to_server; tls.sni; dotprefix; content:".karimdns.com"; endswith; fast_pattern; reference:url,github.com/curl/curl/wiki/DNS-over-HTTPS; classtype:misc-activity; sid:2043906; rev:2; metadata:created_at 2023_01_24, deployment Perimeter, performance_impact Low, confidence High, signature_severity Informational, tag SSL_Malicious_Cert, updated_at 2024_12_01, mitre_tactic_id TA0011, mitre_tactic_name Command_And_Control, mitre_technique_id T1572, mitre_technique_name Protocol_Tunneling;)

# source: PublicRules/et_rules/emerging-malware.rules
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET MALWARE BOT - potential DDoS command (2)"; flowbits:isset,is_proto_irc; flow:established,from_server; content:"ddos"; nocase; pcre:"/ddos\.(phat(icmp|syn|wonk)|stop|(syn|udp|http)flood|targa3|(syn|ack|random) ([0-9]{1,3}\.){3}[0-9]{1,3})/i"; classtype:trojan-activity; sid:2003132; rev:7; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET MALWARE IRC Potential DDoS command 1"; flowbits:isset,is_proto_irc; flow:established,to_client; content:"floodnet "; pcre:"/floodnet ([0-9]{1,3}\.){3}[0-9]{1,3}|(tcp|syn|udp|ack|ping|icmp)(flood)? ([0-9]{1,3}\.){3}[0-9]{1,3}/i"; classtype:trojan-activity; sid:2002032; rev:22; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET MALWARE IRC Potential bot update/download via http command"; flowbits:isset,is_proto_irc; flow:established,to_client; content:" http|3a|//"; fast_pattern:only; pcre:"/\.(upda|getfile|dl\dx|dl|download|execute)\w*\s+http\x3a\x2f\x2f/i"; classtype:trojan-activity; sid:2002031; rev:19; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET MALWARE IRC Channel topic scan/exploit command"; flowbits:isset,is_proto_irc; flow:to_client,established; content:"|3a|"; content:"|20|332|20|"; within: 50; content:"|2023|"; within: 20; content:"|203a|"; nocase; within:40; pcre:"/(ntscan [0-9]{1,4} [0-9]{1,4}|dcom\.self|scan\.(start|stop)|scan ([0-9]{1,3}\.[0-9]{1,3})|(advscan|asc|xscan|xploit|adv\.start) (webdav|netbios|ntpass|dcom(2|135|445|1025)|mssql|lsass|optix|upnp|dcass|beagle[12]|mydoom|netdevil|DameWare|kuang2|sub7|iis5ssl|wkssvc|wks1|mysql|wkssvcOth|wkssvcENG|arkeia|arcserve|wins|veritas|netbackup|asn))/i"; classtype:trojan-activity; sid:2002029; rev:11; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
#alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET MALWARE psyBNC IRC Server Connection"; flow:from_server,established; content:"psyBNC@lam3rz"; depth:33; nocase; flowbits:isset,is_proto_irc; reference:url,en.wikipedia.org/wiki/PsyBNC; classtype:misc-activity; sid:2003302; rev:8; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET MALWARE IRC Potential bot scan/exploit command"; flowbits:isset,is_proto_irc; flow:established,from_server; content:"PRIVMSG|20|"; depth:8; content:"|3a|"; within:30; pcre:"/(ntscan [0-9]{1,4} [0-9]{1,4}|dcom\.self|scan\.(start|stop)|scan ([0-9]{1,3}\.[0-9]{1,3})|(advscan|exploited|asc|xscan|xploit|adv\.start) (webdav|netbios|ntpass|dcom(2|135|445|1025)|mssql|lsass|optix|upnp|dcass|beagle[12]|mydoom|netdevil|DameWare|kuang2|sub7|iis5ssl|wkssvc|wks1|mysql|wkssvcOth|wkssvcENG|arkeia|arcserve|wins|veritas|netbackup|asn))/i"; classtype:trojan-activity; sid:2002030; rev:16; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE Proxy.Corpes.j Infection Report"; flow:established,to_server; content:".php?tma="; http_uri; content:"&mode="; http_uri; pcre:"/mode=\d+D[0-9A-F]{150}/U"; classtype:trojan-activity; sid:2008144; rev:6; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE Cosmu Process Dump Report"; flow:established,to_server; content:"] Dumping processes {|0d 0a|"; classtype:trojan-activity; sid:2011234; rev:4; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE DNSChanger.AT or related Infection Checkin Post"; flow:established,to_server; content:"POST /cgi-bin/generator HTTP/1.0|0d 0a|Content-Length|3a| "; depth:50; content:"|0d 0a 0d 0a|"; within:10; classtype:command-and-control; sid:2008940; rev:6; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE Daonol C&C Communication"; flow:established,to_server; content:"/x/?0"; http_uri; nocase; content:"|0d 0a|SS|3a|"; nocase; content:"|0d 0a|Xost|3a|"; nocase; pcre:"/\/x\/\?0\w{35}$/U"; reference:url,www.microsoft.com/security/portal/Threat/Encyclopedia/Entry.aspx?Name=Win32%2fDaonol; reference:url,blog.fireeye.com/research/2009/10/gumblar-not-gumby.html; reference:url,www.iss.net/threats/gumblar.html; reference:url,blog.scansafe.com/journal/2009/10/15/gumblar-website-botnet-awakes.html; classtype:command-and-control; sid:2010164; rev:6; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE Delf HTTP Checkin (1)"; flow:established,to_server; content:"/mydown.asp?"; nocase; http_uri; content:"reg="; nocase; http_uri; content:"&ver="; nocase; http_uri; content:"&tgid="; nocase; http_uri; content:"&address="; nocase; http_uri; content:"&mydo="; nocase; http_uri; content:"&flag="; nocase; http_uri; classtype:command-and-control; sid:2007838; rev:5; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE Delf Checkin via HTTP (up)"; flow:established,to_server; content:"/up.html?"; nocase; http_uri; content:"set="; nocase; http_uri; content:"&pid="; nocase; http_uri; content:"&MAC="; http_uri; nocase; classtype:command-and-control; sid:2007939; rev:5; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE Delf Checkin via HTTP (6)"; flow:established,to_server; content:"GET"; nocase; http_method; content:".php?v="; nocase; http_uri; content:"&u="; nocase; http_uri; content:"&t="; nocase; http_uri; content:"&p="; nocase; http_uri; content:"&=w"; http_uri; nocase; classtype:command-and-control; sid:2008071; rev:6; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE Delf Checkin via HTTP (7)"; flow:established,to_server; content:"POST"; nocase; http_method; content:".php?macros="; nocase; http_uri; content:"&botstatus="; http_uri; nocase; classtype:command-and-control; sid:2008090; rev:6; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE Downloader.Win32.Delf followon POST Data PUSH Packet"; flow:established,to_server; content:"tip="; depth:4; nocase; content:"&cli="; nocase; content:"&tipo="; nocase; reference:url,www.threatexpert.com/threats/trojan-downloader-win32-delf.html; classtype:trojan-activity; sid:2009824; rev:6; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE Dialer"; flow: established,to_server; content:"/getnumtemp.asp?nip=0"; http_uri; nocase; reference:url,isc.sans.org/diary.php?storyid=1388; classtype:trojan-activity; sid:2003083; rev:6; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE Win32.Dialer.buv Sending Information Home"; flow:established,to_server; content:"/exit.php?if="; http_uri; nocase; content:"&cl="; content:"&id="; content:"&ov="; content:"&site="; content:"&tk="; classtype:trojan-activity; sid:2008430; rev:5; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE Dialer.Win32.E-Group.n Checkin"; flow:to_server,established; content:"login="; nocase; http_uri; content:"&brokerid="; nocase; http_uri; content:"&extlogin="; nocase; http_uri; content:"&autosize="; nocase; http_uri; content:"&icp="; nocase; http_uri; content:"&id_site="; nocase; http_uri; content:"&dl_tracker="; nocase; http_uri; content:"&connection_type="; nocase; http_uri; classtype:command-and-control; sid:2008490; rev:7; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

alert http $HOME_NET any -> $HOME_NET any (msg:"ET MALWARE dlink router access attempt"; flow:established,to_server; content:"GET /dlink/hwiz.html HTTP/1.0|0d 0a 0d 0a|"; content:!"|0d 0a|Host|3a| "; classtype:trojan-activity; sid:2008945; rev:6; metadata:created_at 2010_07_30, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp any any -> $HOME_NET 80 (msg:"ET MALWARE SYNful Knock Cisco IOS Router Implant CnC Beacon (INBOUND)"; flow:established,to_server; content:"|00 00 00 00|text|00|"; byte_jump:4,0,relative,post_offset -1; isdataat:!2,relative; reference:url,fireeye.com/blog/threat-research/2015/09/synful_knock_-_acis.html; classtype:command-and-control; sid:2021785; rev:3; metadata:attack_target Client_Endpoint, created_at 2015_09_16, deployment Perimeter, signature_severity Major, tag c2, updated_at 2019_07_26, mitre_tactic_id TA0010, mitre_tactic_name Exfiltration, mitre_technique_id T1041, mitre_technique_name Exfiltration_Over_C2_Channel;)

# source: PublicRules/et_rules/emerging-malware.rules
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET MALWARE Zberp/ZeusVM receiving config via image file (steganography) 3"; flow:from_server,established; flowbits:isset,ET.Zberp; file_data; content:"0103F|00|"; distance:0; content:"|ff fe ff ff|"; distance:-10; within:4; pcre:"/^0103F\x00[^\x00]+(\xff\xd9)?$/R"; reference:md5,7ba76b0ec1249b19a46e1603e5ab0a90; reference:url,blog.malwarebytes.org/security-threat/2014/02/hiding-in-plain-sight-a-story-about-a-sneaky-banking-trojan/; classtype:trojan-activity; sid:2021527; rev:5; metadata:created_at 2015_07_23, signature_severity Major, updated_at 2019_07_26;)

alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Linux.Mirai Login Attempt (xc3511)"; flow:to_server,established; content:"xc3511|0d 0a|"; dsize:8; reference:url,www.flashpoint-intel.com/when-vulnerabilities-travel-downstream; classtype:trojan-activity; sid:2023333; rev:4; metadata:affected_product DVR, attack_target IoT, created_at 2016_10_10, deployment Datacenter, malware_family ddos_bot, performance_impact Low, confidence High, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (1111111)"; flow:to_server,established; content:"1111111|0d 0a|"; nocase; dsize:9; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023430; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (54321)"; flow:to_server,established; content:"54321|0d 0a|"; nocase; dsize:7; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023431; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (666666)"; flow:to_server,established; content:"666666|0d 0a|"; nocase; dsize:8; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023432; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (7ujMko0admin)"; flow:to_server,established; content:"7ujMko0admin|0d 0a|"; nocase; dsize:14; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023433; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (7ujMko0vizxv)"; flow:to_server,established; content:"7ujMko0vizxv|0d 0a|"; nocase; dsize:14; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023434; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (888888)"; flow:to_server,established; content:"888888|0d 0a|"; nocase; dsize:8; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023435; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (anko)"; flow:to_server,established; content:"anko|0d 0a|"; nocase; dsize:6; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023436; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (dreambox)"; flow:to_server,established; content:"dreambox|0d 0a|"; nocase; dsize:10; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023437; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (fucker)"; flow:to_server,established; content:"fucker|0d 0a|"; nocase; dsize:8; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023438; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (hi3518)"; flow:to_server,established; content:"hi3518|0d 0a|"; nocase; dsize:8; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023439; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (ikwb)"; flow:to_server,established; content:"ikwb|0d 0a|"; nocase; dsize:6; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023440; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (juantech)"; flow:to_server,established; content:"juantech|0d 0a|"; nocase; dsize:10; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023441; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (jvbzd)"; flow:to_server,established; content:"jvbzd|0d 0a|"; nocase; dsize:7; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023442; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (klv123)"; flow:to_server,established; content:"klv123|0d 0a|"; nocase; dsize:8; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023443; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (klv1234)"; flow:to_server,established; content:"klv1234|0d 0a|"; nocase; dsize:9; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023444; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (meinsm)"; flow:to_server,established; content:"meinsm|0d 0a|"; nocase; dsize:8; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023445; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (realtek)"; flow:to_server,established; content:"realtek|0d 0a|"; nocase; dsize:9; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023446; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (service)"; flow:to_server,established; content:"service|0d 0a|"; nocase; dsize:9; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023447; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (ubnt)"; flow:to_server,established; content:"ubnt|0d 0a|"; nocase; dsize:6; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023448; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (vizxv)"; flow:to_server,established; content:"vizxv|0d 0a|"; nocase; dsize:7; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023449; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (xmhdipc)"; flow:to_server,established; content:"xmhdipc|0d 0a|"; nocase; dsize:9; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023450; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (zlxx)"; flow:to_server,established; content:"zlxx|0d 0a|"; nocase; dsize:6; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023451; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323] (msg:"ET MALWARE Possible Linux.Mirai Login Attempt (Zte521)"; flow:to_server,established; content:"Zte521|0d 0a|"; nocase; dsize:8; reference:url,krebsonsecurity.com/2016/10/who-makes-the-iot-things-under-attack; classtype:attempted-admin; sid:2023452; rev:2; metadata:affected_product Linux, attack_target IoT, created_at 2016_10_26, deployment Datacenter, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [6789] (msg:"ET MALWARE Possible Linux.Mirai DaHua Default Credentials Login"; flow:to_server,established; content:"888888|0d 0a|888888"; depth:14; content:"busybox telnetd -p"; distance:0; reference:url,isc.sans.edu/diary/21833; classtype:attempted-admin; sid:2023674; rev:1; metadata:attack_target IoT, created_at 2016_12_20, deployment Perimeter, performance_impact Low, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-malware.rules
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE D-Link ShareCenter (DNS-320/325) RCE (Outbound)"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/cgi-bin/system_mgr.cgi?cmd=cgi_sms_test&command1="; startswith; fast_pattern; reference:url,roberto.greyhats.it/advisories/20120208-dlink-rce.txt/; classtype:web-application-attack; sid:2030121; rev:1; metadata:affected_product Router, attack_target Client_Endpoint, created_at 2020_05_07, deployment Perimeter, confidence High, signature_severity Major, updated_at 2020_05_07;)

# source: PublicRules/et_rules/emerging-malware.rules
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE ELF/Muhstik Attempting to Download Payload"; flow:established,to_server; http.method; content:"GET"; http.uri; content:".php?port="; fast_pattern; http.user_agent; content:"wget/"; http.header_names; content:!"Referer"; reference:url,blog.netlab.360.com/gpon-exploit-in-the-wild-i-muhstik-botnet-among-others-en/; classtype:trojan-activity; sid:2025575; rev:3; metadata:affected_product Linux, attack_target Networking_Equipment, created_at 2018_05_11, deployment Perimeter, malware_family Muhstik, performance_impact Low, confidence High, signature_severity Major, updated_at 2020_08_25;)

# source: PublicRules/et_rules/emerging-malware.rules
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE MSIL/CoinMiner Performing System Checkin"; flow:established,to_server; http.uri; content:"/ReportSpeed"; endswith; fast_pattern; http.request_body; content:"|2c 22|GpuDriver|22 3a 22|"; content:"|2c 22|OSName|22 3a 22|"; content:"|2c 22|DiskSpace|22 3a 22|"; reference:md5,0bdfccd5aab30f98e212abde79d923ef; classtype:coin-mining; sid:2030812; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2020_08_28, deployment Perimeter, malware_family MSIL_CoinMiner, confidence High, signature_severity Major, tag Coinminer, updated_at 2020_08_28, mitre_tactic_id TA0040, mitre_tactic_name Impact, mitre_technique_id T1496, mitre_technique_name Resource_Hijacking;)

# source: PublicRules/et_rules/emerging-malware.rules
alert dns $HOME_NET any -> any any (msg:"ET MALWARE Observed SystemBC CnC Domain in DNS Query"; dns.query; content:"advertsp74.xyz"; nocase; depth:14; endswith; reference:url,news.sophos.com/en-us/2020/12/16/systembc; classtype:trojan-activity; sid:2031421; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, created_at 2020_12_17, deployment Perimeter, confidence High, signature_severity Major, updated_at 2020_12_17;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET !443 -> $HOME_NET any (msg:"ET MALWARE ELF/MooBot Mirai DDoS Variant Server Response"; flow:established,to_client; dsize:3; content:"|33 66 99|"; reference:md5,0e4c2aa30a72fd75ef49c430fd767fa0; reference:url,blog.netlab.360.com/ddos-botnet-moobot-en; classtype:command-and-control; sid:2030489; rev:2; metadata:affected_product Linux, attack_target Client_Endpoint, created_at 2020_07_09, deployment Perimeter, malware_family Mirai, malware_family MooBot, confidence High, signature_severity Major, updated_at 2021_09_02;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET ![443,80] -> $HOME_NET any (msg:"ET MALWARE ELF/MooBot Mirai DDoS Variant Server Keep Alive"; flow:established,to_client; dsize:4; content:"|13 11 18 19|"; threshold:type threshold, count 4, seconds 40, track by_src; reference:md5,b3be367b4868d39d6978d27f4d4dfaaf; reference:url,www.fortinet.com/blog/threat-research/mirai-based-botnet-moobot-targets-hikvision-vulnerability; reference:url,blog.netlab.360.com/ddos-botnet-moobot-en/; classtype:command-and-control; sid:2034639; rev:2; metadata:affected_product Linux, attack_target Client_Endpoint, created_at 2021_12_09, deployment Perimeter, malware_family ELF_MooBot, confidence High, signature_severity Major, updated_at 2021_12_09;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $EXTERNAL_NET ![443,80] -> $HOME_NET any (msg:"ET MALWARE ELF/MooBot Mirai DDoS Variant Server Response M2"; flow:established,to_client; dsize:<48; content:"|00 00 00 3c|"; startswith; fast_pattern; content:"|01|"; distance:1; within:1; content:"|20|"; distance:4; within:1; pcre:"/^[\x01-\x04]/R"; reference:md5,b3be367b4868d39d6978d27f4d4dfaaf; reference:url,www.fortinet.com/blog/threat-research/mirai-based-botnet-moobot-targets-hikvision-vulnerability; reference:url,blog.netlab.360.com/ddos-botnet-moobot-en/; classtype:command-and-control; sid:2034640; rev:2; metadata:affected_product Linux, attack_target Client_Endpoint, created_at 2021_12_09, deployment Perimeter, malware_family ELF_MooBot, performance_impact Significant, confidence High, signature_severity Major, updated_at 2021_12_09;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $HOME_NET any -> $EXTERNAL_NET ![443,80] (msg:"ET MALWARE ELF/MooBot Mirai DDoS Variant CnC Checkin M3"; flow:established,to_server; stream_size:server,<,5; dsize:6; content:"|13 11 18 19 01 68|"; reference:md5,b3be367b4868d39d6978d27f4d4dfaaf; reference:url,www.fortinet.com/blog/threat-research/mirai-based-botnet-moobot-targets-hikvision-vulnerability; reference:url,blog.netlab.360.com/ddos-botnet-moobot-en/; classtype:command-and-control; sid:2034638; rev:2; metadata:affected_product Linux, attack_target Client_Endpoint, created_at 2021_12_09, deployment SSLDecrypt, malware_family ELF_MooBot, confidence High, signature_severity Minor, updated_at 2021_12_09;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp $HOME_NET any -> $EXTERNAL_NET [!80,!443,!445] (msg:"ET MALWARE Win32/Orchard Botnet Activity M2"; flow:established,to_server; content:"|7b 22|Identity|22 3a 22|"; content:"|22 2c 22|Architecture|22 3a|"; distance:0; content:"|2c 22|Antivirus|22 3a 5b|"; distance:1; content:"|2c 22|DotNetStatus|22 3a|"; distance:0; content:"|2c 22|Bot_Version|22 3a 22|"; fast_pattern; distance:0; reference:url,blog.netlab.360.com/orchard-dga/; reference:md5,f3e0b960a48b433bc4bfe6ac44183b74; classtype:trojan-activity; sid:2038706; rev:1; metadata:attack_target Client_Endpoint, created_at 2022_09_01, deployment Perimeter, malware_family Win32_Orchard, confidence High, signature_severity Major, updated_at 2022_09_01;)

# source: PublicRules/et_rules/emerging-malware.rules
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE WikiLoader Activity M3 (GET)"; flow:established,to_server; flowbits:set,ET.wikiloader; http.method; content:"GET"; http.uri; content:".php?id=1"; endswith; http.header_names; content:"|0d 0a|Accept|0d 0a|Cookie|0d 0a|"; startswith; content:!"Referer|0d 0a|"; http.user_agent; content:"|3b 20|yie10|3b 20|"; fast_pattern; reference:md5,c5b76423675f8ef473225a753f0ce626; reference:url,securityintelligence.com/x-force/wailingcrab-malware-misues-mqtt-messaging-protocol/; classtype:trojan-activity; sid:2049274; rev:1; metadata:attack_target Client_Endpoint, created_at 2023_11_21, deployment Perimeter, deployment SSLDecrypt, confidence Medium, signature_severity Major, updated_at 2023_11_21; target:src_ip;)

# source: PublicRules/et_rules/emerging-malware.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET MALWARE WikiLoader Activity M4 (Response)"; flow:established,to_client; flowbits:set,ET.wikiloader; file.data; content:"</option><!--gmail|20|"; fast_pattern; pcre:"/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})/R"; content:"|20|-->"; distance:0; reference:md5,c5b76423675f8ef473225a753f0ce626; reference:url,securityintelligence.com/x-force/wailingcrab-malware-misues-mqtt-messaging-protocol/; classtype:trojan-activity; sid:2049275; rev:1; metadata:attack_target Client_Endpoint, created_at 2023_11_21, deployment Perimeter, deployment SSLDecrypt, confidence High, signature_severity Major, updated_at 2023_11_21; target:dest_ip;)

# source: PublicRules/et_rules/emerging-malware.rules
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE Goldoon Botnet Payload Retrieval Attempt"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/bins/"; startswith; http.user_agent; content:"FBI-Agent|20 28|Checking You|29|"; fast_pattern; reference:url,www.fortinet.com/blog/threat-research/new-goldoon-botnet-targeting-d-link-devices; classtype:trojan-activity; sid:2052394; rev:1; metadata:affected_product Any, attack_target Client_and_Server, tls_state plaintext, created_at 2024_05_03, deployment Perimeter, malware_family Goldoon, performance_impact Low, confidence High, signature_severity Major, updated_at 2024_05_03; target:src_ip;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp-pkt $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE Goldoon Botnet CnC Checkin (SystemInfo)"; flow:established,to_server; flowbits:set,ET.Goldoon.Checkin; dsize:10; content:"SystemInfo"; fast_pattern; reference:url,www.fortinet.com/blog/threat-research/new-goldoon-botnet-targeting-d-link-devices; classtype:trojan-activity; sid:2052395; rev:1; metadata:affected_product Any, attack_target Client_and_Server, tls_state plaintext, created_at 2024_05_03, deployment Perimeter, malware_family Goldoon, performance_impact Low, confidence Medium, signature_severity Major, updated_at 2024_05_03; target:src_ip;)

# source: PublicRules/et_rules/emerging-malware.rules
alert tcp-pkt $EXTERNAL_NET any -> $HOME_NET any (msg:"ET MALWARE Goldoon Botnet CnC Response (Tasking)"; flow:established,to_client; flowbits:isset,ET.Goldoon.Checkin; content:"|00 00 00 01 00 00 00 0a 00 00 00 06|Thread|00 00 00|"; startswith; fast_pattern; content:"|04|Time|00 00 00|"; within:40; content:"|06|Method|00 00 00|"; within:40; content:"|08|AttackId|00 00 00|"; within:40; content:"|08|Hostname|00 00 00|"; within:40; content:"|08|Protocol|00 00 00|"; within:40; content:"|06|Target|00 00 00|"; within:30; content:"|04|Type|00 00 00|"; within:100; content:"|05|dPort|00 00 00|"; within:40; content:"|04|IsV6|00 00 00|"; within:40; threshold:type limit, seconds 120, count 1, track by_dst; reference:url,www.fortinet.com/blog/threat-research/new-goldoon-botnet-targeting-d-link-devices; classtype:trojan-activity; sid:2052396; rev:1; metadata:affected_product Any, attack_target Client_and_Server, tls_state plaintext, created_at 2024_05_03, deployment Perimeter, malware_family Goldoon, performance_impact Low, confidence High, signature_severity Major, updated_at 2024_05_03; target:dest_ip;)

# source: PublicRules/et_rules/emerging-malware.rules
alert http any any -> $HOME_NET any (msg:"ET MALWARE PolarEdge TLS Backdoor Installation Attempt"; flow:established,to_server; http.uri; content:"/cgi-bin/"; startswith; pcre:"/^(?:config|config_mirror)\x2eexp\x3f/R"; content:"/tmp|3b|busybox"; distance:0; fast_pattern; content:"ftpget"; distance:0; http.header; content:"Referer|3a 20|https|3a 2f 2f|"; content:".htm|0d 0a|"; distance:0; reference:url,blog.sekoia.io/polaredge-unveiling-an-uncovered-iot-botnet/; classtype:attempted-admin; sid:2060442; rev:1; metadata:affected_product IoT, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_02_28, deployment Perimeter, deployment Internal, malware_family PolarEdge, performance_impact Low, confidence High, signature_severity Major, updated_at 2025_02_28, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-misc.rules
#alert tcp $EXTERNAL_NET 119 -> $HOME_NET any (msg:"GPL MISC return code buffer overflow attempt"; flow:to_client,established,no_stream; content:"200"; isdataat:64,relative; pcre:"/^200\s[^\n]{64}/smi"; reference:bugtraq,4900; reference:cve,2002-0909; classtype:protocol-command-decode; sid:2101792; rev:10; metadata:created_at 2010_09_23, confidence High, signature_severity Major, updated_at 2019_07_26;)

alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"GPL MISC UPnP Location overflow"; content:"Location|3A|"; nocase; isdataat:128,relative; pcre:"/^Location\x3a[^\n]{128}/smi"; reference:bugtraq,3723; reference:cve,2001-0876; classtype:misc-attack; sid:2101388; rev:14; metadata:created_at 2010_09_23, cve CVE_2001_0876, signature_severity Informational, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-misc.rules
alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"GPL MISC UPnP malformed advertisement"; content:"NOTIFY * "; nocase; reference:bugtraq,3723; reference:cve,2001-0876; reference:cve,2001-0877; reference:url,www.microsoft.com/technet/security/bulletin/MS01-059.mspx; classtype:misc-attack; sid:2101384; rev:9; metadata:created_at 2010_09_23, cve CVE_2001_0876, signature_severity Informational, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-policy.rules
alert http $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"GPL POLICY Linksys router default password login attempt"; flow:to_server,established; http.header; content:"Authorization|3a 20|OmFkbWlu"; nocase; reference:nessus,10999; classtype:default-login-attempt; sid:2101860; rev:10; metadata:created_at 2010_09_23, confidence Medium, signature_severity Informational, updated_at 2020_04_20;)

# source: PublicRules/et_rules/emerging-policy.rules
alert http $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"GPL POLICY Linksys router default username and password login attempt"; flow:to_server,established; http.header; content:"Authorization|3a 20|YWRtaW46YWRtaW4"; nocase; reference:nessus,10999; classtype:default-login-attempt; sid:2101861; rev:13; metadata:created_at 2010_09_23, confidence Medium, signature_severity Informational, updated_at 2020_04_20;)

# source: PublicRules/et_rules/emerging-policy.rules
alert http $HOME_NET any -> $HOME_NET any (msg:"ET POLICY Dlink Soho Router Config Page Access Attempt"; flow:established,to_server; http.uri; content:"/dlink/hwiz.html"; classtype:attempted-admin; sid:2008942; rev:8; metadata:created_at 2010_07_30, confidence High, signature_severity Informational, updated_at 2020_04_21;)

# source: PublicRules/et_rules/emerging-scan.rules
alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"ET SCAN External to Internal UPnP Request udp port 1900"; content:"MSEARCH * HTTP/1.1"; depth:18; content:"MAN|3a| ssdp|3a|"; nocase; distance:0; reference:url,www.upnp-hacks.org/upnp.html; classtype:attempted-recon; sid:2008094; rev:4; metadata:created_at 2010_07_30, confidence Medium, signature_severity Informational, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-scan.rules
alert tcp $HOME_NET any -> $HOME_NET 2555 (msg:"ET SCAN Internal to Internal UPnP Request tcp port 2555"; flow:established,to_server; content:"GET "; depth:4; content:"/upnp/"; nocase; pcre:"/^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{16}\//Ri"; reference:url,www.upnp-hacks.org/upnp.html; classtype:attempted-recon; sid:2008092; rev:4; metadata:created_at 2010_07_30, confidence Medium, signature_severity Informational, updated_at 2019_09_26;)

# source: PublicRules/et_rules/emerging-scan.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET 2555 (msg:"ET SCAN External to Internal UPnP Request tcp port 2555"; flow:established,to_server; content:"GET "; depth:4; content:"/upnp/"; nocase; pcre:"/^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{16}\//Ri"; reference:url,www.upnp-hacks.org/upnp.html; classtype:attempted-recon; sid:2008093; rev:6; metadata:created_at 2010_07_30, confidence Medium, signature_severity Informational, updated_at 2019_09_26;)

# source: PublicRules/et_rules/emerging-scan.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET SCAN UPnP SUBSCRIBE Inbound - Possible CallStranger Scan (CVE-2020-12695)"; flow:established,to_server; http.method; content:"SUBSCRIBE"; nocase; http.header; content:"CALLBACK|3a 20|"; fast_pattern; content:"NT|3a 20|"; reference:cve,2020-12695; reference:url,kb.cert.org/vuls/id/339275; classtype:attempted-recon; sid:2030272; rev:2; metadata:attack_target Client_Endpoint, created_at 2020_06_09, cve CVE_2020_12695, deployment Perimeter, confidence Medium, signature_severity Informational, updated_at 2020_06_09;)

# source: PublicRules/et_rules/emerging-scan.rules
alert http any any -> $HOME_NET any (msg:"ET SCAN Hikvision IP Camera 5.4.0 Information Disclosure"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/System/configurationFile?auth=YWRtaW46MTEK"; reference:url,exploit-db.com/exploits/45231/; classtype:attempted-recon; sid:2026015; rev:2; metadata:attack_target IoT, created_at 2018_08_22, deployment Datacenter, performance_impact Low, confidence Medium, signature_severity Major, updated_at 2020_08_25, mitre_tactic_id TA0007, mitre_tactic_name Discovery, mitre_technique_id T1082, mitre_technique_name System_Information_Discovery;)

# source: PublicRules/et_rules/emerging-telnet.rules
#alert tcp $HOME_NET 23 -> $EXTERNAL_NET any (msg:"ET TELNET External Telnet Login Prompt from Cisco Device"; flow:from_server,established; pcre:"/^(\r\n)*/"; content:"User Access Verification"; within:24; classtype:attempted-admin; sid:2008861; rev:6; metadata:created_at 2010_07_30, signature_severity Informational, updated_at 2019_07_26;)

alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323,3323,4323] (msg:"ET TELNET busybox MIRAI hackers - Possible Brute Force Attack"; flow:to_server,established; content:"MIRAI"; flowbits:isset,ET.telnet.busybox; threshold: type limit, count 1, track by_src, seconds 30; reference:url,lists.emergingthreats.net/pipermail/emerging-sigs/2016-August/027524.html; classtype:attempted-admin; sid:2023019; rev:2; metadata:attack_target Server, created_at 2016_08_08, deployment Datacenter, performance_impact Low, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-telnet.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323,3323,4323] (msg:"ET TELNET busybox ECCHI hackers - Possible Brute Force Attack"; flow:to_server,established; content:"ECCHI"; flowbits:isset,ET.telnet.busybox; threshold: type limit, count 1, track by_src, seconds 30; reference:url,lists.emergingthreats.net/pipermail/emerging-sigs/2016-August/027524.html; classtype:attempted-admin; sid:2023304; rev:1; metadata:attack_target Server, created_at 2016_09_27, deployment Datacenter, performance_impact Low, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-telnet.rules
alert tcp $EXTERNAL_NET any -> $HOME_NET [23,2323,3323,4323] (msg:"ET TELNET busybox MEMES Hackers - Possible Brute Force Attack"; flow:to_server,established; content:"MEMES"; flowbits:isset,ET.telnet.busybox; threshold: type limit, count 1, track by_src, seconds 30; reference:url,lists.emergingthreats.net/pipermail/emerging-sigs/2016-August/027524.html; classtype:attempted-admin; sid:2023901; rev:1; metadata:affected_product Linux, attack_target Networking_Equipment, created_at 2017_02_14, deployment Perimeter, malware_family Mirai, performance_impact Moderate, confidence Medium, signature_severity Major, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-web_client.rules
# Emerging Threats 
#
# This distribution may contain rules under two different licenses. 
#
#  Rules with sids 1 through 3464, and 100000000 through 100000908 are under the GPLv2.
#  A copy of that license is available at http://www.gnu.org/licenses/gpl-2.0.html
#
#  Rules with sids 2000000 through 2799999 are from Emerging Threats and are covered under the BSD License 
#  as follows:
#
#*************************************************************
#  Copyright (c) 2003-2025, Emerging Threats
#  All rights reserved.
#  
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the 
#  following conditions are met:
#  
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following 
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the 
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived 
#    from this software without specific prior written permission.
#  
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES, 
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE 
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, 
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR 
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, 
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE 
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. 
#
#*************************************************************
#
#
#
#

# This Ruleset is EmergingThreats Open optimized for suricata-5.0-enhanced.

#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Java Deployment Toolkit Launch Method Remote Code Execution Attempt"; flow:established,to_client; content:"-J-jar -J"; pcre:"/(launch\x28.+-J-jar -J|-J-jar -J.+launch\x28)/i"; reference:url,seclists.org/fulldisclosure/2010/Apr/119; reference:url,www.darknet.org.uk/2010/04/serious-java-bug-exposes-users-to-code-execution/; classtype:attempted-user; sid:2011053; rev:3; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, confidence Medium, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT DX Studio Player Firefox Plug-in Command Injection Attempt"; flow:established,to_client; content:"<dxstudio"; nocase; content:"shell.execute("; nocase; reference:cve,2009-2011; classtype:attempted-user; sid:2010841; rev:4; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26, mitre_tactic_id TA0008, mitre_tactic_name Lateral_Movement, mitre_technique_id T1210, mitre_technique_name Exploitation_Of_Remote_Services;)

#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible HTTP 403 XSS Attempt (External Source)"; flow:from_server,established; content:"HTTP/1.1 403 Forbidden|0d 0a|"; depth:24; nocase; content:"<script"; nocase; within:512; classtype:web-application-attack; sid:2010516; rev:4; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, confidence Medium, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible HTTP 404 XSS Attempt (External Source)"; flow:from_server,established; content:"HTTP/1.1 404 Not Found|0d 0a|"; depth:24; nocase; content:"<script"; nocase; within:512; classtype:web-application-attack; sid:2010518; rev:4; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, confidence Medium, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Malvertising drive by kit encountered - Loading..."; flow:established,to_client; content:"HTTP/1"; depth:6; content:"<html><head></head><body>Loading...<div id=|22|page|22| style=|22|display|3a| none|22|>"; nocase; classtype:bad-unknown; sid:2011223; rev:5; metadata:created_at 2010_07_30, signature_severity Unknown, updated_at 2019_07_26;)

#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Internet Explorer javascript onUnload http spliting attempt (body)"; flow:from_server,established; content:"body"; nocase; content:"onUnload"; distance:0; nocase; pcre:"/<body\s+[^>]*onUnload\s*=\s*[\x22\x27]?\(\)/"; classtype:web-application-attack; sid:2009132; rev:6; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Internet Explorer javascript onUnload http spliting attempt (img)"; flow:from_server,established; content:"img"; nocase; content:"onUnload"; distance:0; nocase; pcre:"/<img\s+[^>]*onEnd\s*=\s*[\x22\x27]?\(\)/"; classtype:web-application-attack; sid:2009133; rev:6; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Internet Explorer javascript onURLFlip http spliting attempt (body)"; flow:from_server,established; content:"body"; nocase; content:"onURLFlip"; distance:0; nocase; pcre:"/<body\s+[^>]*onURLFlip\s*=\s*[\x22\x27]?\(\)/"; classtype:web-application-attack; sid:2009134; rev:6; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Internet Explorer javascript onURLFlip http spliting attempt"; flow:from_server,established; content:"img"; nocase; content:"onURLFlip"; distance:0; nocase; pcre:"/<img\s+[^>]*onURLFlip\s*=\s*[\x22\x27]?\(\)/"; classtype:web-application-attack; sid:2009135; rev:6; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible Microsoft Internet Explorer mshtml.dll Timer ID Memory Pointer Information Disclosure Attempt"; flow:established,to_client; content:"setInterval("; nocase; content:"document.getElementById"; nocase; distance:0; content:".innerHTML"; nocase; distance:0; content:".toString("; nocase; within:60; reference:url,tools.cisco.com/security/center/viewAlert.x?alertId=20815; reference:url,reversemode.com/index.php?option=com_content&task=view&id=68&Itemid=1; classtype:attempted-user; sid:2011764; rev:4; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, confidence Medium, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26, mitre_tactic_id TA0007, mitre_tactic_name Discovery, mitre_technique_id T1082, mitre_technique_name System_Information_Discovery;)

#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT RealPlayer/Helix Player Format String Exploit"; flow:established,from_server; content:"<imfl>"; pcre:"/<[^>%]*%/R"; content:"</imfl>"; distance:0; reference:url,milw0rm.com/id.php?id=1232; reference:bugtraq,14945; reference:cve,2005-2710; classtype:web-application-attack; sid:2002381; rev:10; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Attempt to execute VBScript code"; flow: from_server,established; content:"vbscript"; nocase; pcre:"/(((URL|SRC|HREF|LOWSRC)[\s]*=)|(url[\s]*[\(]))[\s]*['"]*vbscript[\:]/i"; classtype:misc-attack; sid:2001099; rev:10; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Stealth attempt to execute Javascript code"; flow: from_server,established; pcre:"/(((URL|SRC|HREF|LOWSRC)[\s]*=)|(url[\s]*[\(]))[\s]*['"]*[\x09\x0a\x0b\x0c\x0d]*j[\x09\x0a\x0b\x0c\x0d]*a[\x09\x0a\x0b\x0c\x0d]*v[\x09\x0a\x0b\x0c\x0d]*a[\x09\x0a\x0b\x0c\x0d]*s[\x09\x0a\x0b\x0c\x0d]*c[\x09\x0a\x0b\x0c\x0d]*r[\x09\x0a\x0b\x0c\x0d]*i[\x09\x0a\x0b\x0c\x0d]*p[\x09\x0a\x0b\x0c\x0d]*t[\x09\x0a\x0b\x0c\x0d]*[\:]/i"; content:"="; content:!"javascript|3a|"; nocase; classtype:misc-attack; sid:2001101; rev:13; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Stealth attempt to execute VBScript code"; flow: from_server,established; pcre:"/(((URL|SRC|HREF|LOWSRC)[\s]*=)|(url[\s]*[\(]))[\s]*['"]*[\x09\x0a\x0b\x0c\x0d]*v[\x09\x0a\x0b\x0c\x0d]*b[\x09\x0a\x0b\x0c\x0d]*s[\x09\x0a\x0b\x0c\x0d]*c[\x09\x0a\x0b\x0c\x0d]*r[\x09\x0a\x0b\x0c\x0d]*i[\x09\x0a\x0b\x0c\x0d]*p[\x09\x0a\x0b\x0c\x0d]*t[\x09\x0a\x0b\x0c\x0d]*[\:]/i"; content:"="; content:!"vbscript|3a|"; nocase; classtype:misc-attack; sid:2001102; rev:13; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Stealth attempt to access SHELL#=#="; flow: from_server,established; pcre:"/(((URL|SRC|HREF|LOWSRC)[\s]*=)|(url[\s]*[\(]))[\s]*['"]*[\x09\x0a\x0b\x0c\x0d]*s[\x09\x0a\x0b\x0c\x0d]*h[\x09\x0a\x0b\x0c\x0d]*e[\x09\x0a\x0b\x0c\x0d]*l[\x09\x0a\x0b\x0c\x0d]*l[\x09\x0a\x0b\x0c\x0d]*[\:]/i"; content:"="; content:!"shell|3a|"; nocase; classtype:misc-attack; sid:2001103; rev:13; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Javascript execution with expression eval"; flow: from_server,established; content:"string.fromcharcode"; nocase; pcre:"/expression[\s]*\([\s]*eval[\s]*\([\s]*String\.fromCharCode[\s]*\(([\s]*[\d]+[\s]*,){20}/i"; reference:url,www.securiteam.com/exploits/3D5Q4RFPPK.html; classtype:misc-activity; sid:2001105; rev:11; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Javascript execution with expression eval hex"; flow: from_server,established; content:"String.FromCharCode"; nocase; pcre:"/expression[\s]*\([\s]*eval[\s]*\([\s]*String\.fromCharCode[\s]*\(([\s]*0x[\da-fA-F]+[\s]*,){20}/i"; reference:url,www.securiteam.com/exploits/3D5Q4RFPPK.html; classtype:misc-activity; sid:2001106; rev:10; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT IE process injection iexplore.exe executable download"; flow: from_server,established; content:"|00|iexplore.exe|00|"; content:"|00|GetProcAddress|00|"; content:"|00|LoadLibraryA|00|"; classtype:misc-activity; sid:2001048; rev:9; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT MSIE WebViewFolderIcon setSlice invalid memory copy"; flow:to_client,established; content:"WebViewFolderIcon"; nocase; content:".setSlice"; nocase; content:"0x7ffffff"; nocase; reference:url,riosec.com/msie-setslice-vuln; reference:url,osvdb.org/27110; reference:cve,2006-3730; classtype:attempted-user; sid:2003110; rev:7; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

#alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Microsoft IE FTP URL Arbitrary Command Injection"; flow:from_server,established; content:"ftp|3a|//"; nocase; pcre:"/ftp\://[^\' \"]*%0a/i"; reference:url,osvdb.org/12299; reference:cve,2004-1166; classtype:attempted-user; sid:2003230; rev:7; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, confidence Low, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26, mitre_tactic_id TA0008, mitre_tactic_name Lateral_Movement, mitre_technique_id T1210, mitre_technique_name Exploitation_Of_Remote_Services;)

#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Wscript Shell Run Attempt - Likely Hostile"; flow:established,to_client; content:"WScript.Shell"; nocase; content:"shell.Run"; nocase; within:40; content:"|22|"; within:6; reference:url,msdn.microsoft.com/en-us/library/d5fk67ky(VS.85).aspx; classtype:attempted-user; sid:2010961; rev:5; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, confidence Medium, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

#alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET WEB_CLIENT Possible String.FromCharCode Javascript Obfuscation Attempt"; flow:established,to_client; content:"String.FromCharCode("; nocase; pcre:"/String\x2EFromCharCode\x28[0-9]{1,3}/i"; reference:url,www.w3schools.com/jsref/jsref_fromCharCode.asp; reference:url,www.roseindia.net/javascript/method-fromcharcode.shtml; reference:url,isc.sans.org/diary.html?storyid=7906; reference:url,isc.sans.org/diary.html?storyid=7903; classtype:bad-unknown; sid:2011347; rev:2; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_09_28, deployment Perimeter, confidence Medium, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

alert udp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Apple Quicktime RTSP Content-Type overflow attempt"; content:"RTSP/"; nocase; depth:5; content:"|0a|Content-Type|3a|"; nocase; distance:0; isdataat:50,relative; content:!"|0a|"; within:50; reference:url,www.kb.cert.org/vuls/id/659761; reference:url,www.milw0rm.com/exploits/4657; classtype:attempted-user; sid:2007704; rev:6; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, confidence Medium, signature_severity Major, tag Web_Client_Attacks, updated_at 2019_07_26;)

# source: PublicRules/et_rules/emerging-web_client.rules
#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Iframe in Purported Image Download (jpeg) - Likely SQL Injection Attacks Related"; flow:established,from_server; content:"|0d 0a|content-type|3a| "; nocase; content:" image/jpeg"; nocase; within:30; content:"<iframe"; nocase; distance:0; pcre:"/content-type\x3a\s+image\/jpeg/i"; pcre:"/<iframe.*?src.*?>.*?<\/iframe>/im"; classtype:web-application-attack; sid:2008313; rev:8; metadata:affected_product Web_Browsers, affected_product Web_Server_Applications, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, deployment Datacenter, confidence Medium, signature_severity Major, tag SQL_Injection, tag Web_Client_Attacks, updated_at 2020_08_20, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Iframe in Purported Image Download (gif) - Likely SQL Injection Attacks Related"; flow:established,from_server; content:"|0d 0a|content-type|3a| "; nocase; content:" image/gif"; nocase; within:30; content:"<iframe"; nocase; distance:0; pcre:"/content-type\x3a\s+image\/gif/i"; pcre:"/<iframe.*?src.*?>.*?<\/iframe>/im"; classtype:web-application-attack; sid:2008314; rev:8; metadata:affected_product Web_Browsers, affected_product Web_Server_Applications, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, deployment Perimeter, deployment Datacenter, confidence Medium, signature_severity Major, tag SQL_Injection, tag Web_Client_Attacks, updated_at 2020_08_20, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Obfuscated Javascript redirecting to badness August 6 2012"; flow:established,from_server; content:"text/javascript'>var wow="; content:"document.cookie.indexOf"; within:70; classtype:bad-unknown; sid:2015578; rev:3; metadata:created_at 2012_08_07, signature_severity Major, updated_at 2020_08_20, mitre_tactic_id TA0005, mitre_tactic_name Defense_Evasion, mitre_technique_id T1027, mitre_technique_name Obfuscated_Files_or_Information;)

#alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Fake Trojan Dropper purporting to be missing application page landing"; flow:established,from_server; content:"Unable to find |22|"; content:"|20|Please Click Here to install......"; within:85; classtype:trojan-activity; sid:2017301; rev:3; metadata:created_at 2013_08_08, signature_severity Major, updated_at 2020_08_20;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Apple Quicktime RTSP Overflow (1)"; flow:established,from_server; content:"|22|rtsp|3a|//"; nocase; isdataat:400,relative; content:!"|0a|"; within:400; content:!"|22|"; within:400; reference:cve,2007-0015; reference:bugtraq,21829; classtype:attempted-admin; sid:2003326; rev:9; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, cve CVE_2007_0015, deployment Perimeter, signature_severity Major, tag Web_Client_Attacks, updated_at 2020_08_19;)

# source: PublicRules/et_rules/emerging-web_client.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_CLIENT Apple Quicktime RTSP Overflow (2)"; flow:established,from_server; content:"|27|rtsp|3a|//"; nocase; isdataat:400,relative; content:!"|0a|"; within:400; content:!"|27|"; within:400; reference:cve,2007-0015; reference:bugtraq,21829; classtype:attempted-admin; sid:2003327; rev:9; metadata:affected_product Web_Browsers, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, created_at 2010_07_30, cve CVE_2007_0015, deployment Perimeter, signature_severity Major, tag Web_Client_Attacks, updated_at 2020_08_19;)

# source: PublicRules/et_rules/emerging-web_server.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible D-Link Router HNAP Protocol Security Bypass Attempt"; flow:established,to_server; urilen:7; http.method; content:"POST"; http.uri; content:"/HNAP1/"; nocase; endswith; fast_pattern; http.header; content:"SOAPAction|3a 20|"; nocase; content:"/HNAP1/"; distance:0; pcre:"/^(?:set|get)/Ri"; content:"DeviceSettings"; within:14; reference:url,www.securityfocus.com/bid/37690; classtype:web-application-attack; sid:2010698; rev:6; metadata:created_at 2010_07_30, confidence Medium, signature_severity Unknown, updated_at 2020_11_02;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SPECIFIC_APPS PHool mainnav Parameter Remote File inclusion Attempt"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/includes/layout/plain.footer.php?"; nocase; content:"mainnav="; nocase; pcre:"/^\s*(?:ftps?|https?|php)\:\//Ri"; reference:url,packetstormsecurity.org/files/106073/sportsphool-rfi.txt; classtype:web-application-attack; sid:2013815; rev:4; metadata:created_at 2011_10_31, signature_severity Major, updated_at 2020_04_20, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Netgear WNR2000v5 Possible Serial Number Leak"; flow:to_server,established; http.uri; content:"/BRS_netgear_success.html"; nocase; reference:cve,2016-10175; reference:url,cve.circl.lu/cve/CVE-2016-10175; classtype:attempted-recon; sid:2023830; rev:3; metadata:affected_product Netgear_Router, attack_target Client_Endpoint, created_at 2017_02_02, cve CVE_2016_10175, deployment Perimeter, performance_impact Low, confidence Medium, signature_severity Major, updated_at 2020_08_04;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS TOTOLINK setTracerouteCfg Command Injection Attempt (CVE-2023-30013)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/cgi-bin/cstecgi.cgi"; fast_pattern; http.request_body; content:"|7b 22|command|22 3a 22|"; startswith; content:"|3b|"; distance:0; content:"|3b 22 2c 22|"; distance:0; content:"topicurl|22 3a 22|setTracerouteCfg|22 7d|"; endswith; reference:url,attackerkb.com/topics/xnX3I3PEgM/cve-2023-30013; reference:cve,2023-30013; classtype:attempted-admin; sid:2048119; rev:1; metadata:affected_product Router, attack_target Networking_Equipment, created_at 2023_09_19, cve CVE_2023_30013, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, updated_at 2023_09_19, reviewed_at 2023_09_19, mitre_tactic_id TA0008, mitre_tactic_name Lateral_Movement, mitre_technique_id T1210, mitre_technique_name Exploitation_Of_Remote_Services; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS D-Link DIR820 ping.ccp Command Injection Attempt (CVE-2023-25280)"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:9; content:"/ping.ccp"; fast_pattern; http.request_body; content:"ccp_act|3d|"; content:"ping_addr|3d|"; pcre:"/^[^\x26]*?(?:(?:\x3b|%3[Bb])|(?:\x0a|%0[Aa])|(?:\x60|%60)|(?:\x7c|%7[Cc])|(?:\x24|%24))+/R"; reference:url,unit42.paloaltonetworks.com/mirai-variant-targets-iot-exploits/; reference:cve,2023-25280; classtype:attempted-admin; sid:2057248; rev:1; metadata:affected_product D_Link, attack_target Networking_Equipment, tls_state plaintext, created_at 2024_11_05, cve CVE_2023_25280, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, tag CISA_KEV, updated_at 2024_11_05, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Tenda AX3 Command Injection Attempt (CVE-2023-27240)"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:19; content:"/goform/AdvSetLanip"; fast_pattern; http.request_body; content:"lanIp|3a|"; pcre:"/^[^\x26]*?(?:(?:\x3b|%3[Bb])|(?:\x0a|%0[Aa])|(?:\x60|%60)|(?:\x7c|%7[Cc])|(?:\x24|%24))+/R"; reference:url,unit42.paloaltonetworks.com/mirai-variant-targets-iot-exploits/; reference:cve,2023-27240; classtype:attempted-admin; sid:2057253; rev:1; metadata:affected_product Tenda, attack_target Networking_Equipment, tls_state plaintext, created_at 2024_11_05, cve CVE_2023_27240, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2024_11_05, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS D-Link DWL-2600AP Command Injection Attempt (CVE-2019-20499, CVE-2019-20500, CVE-2019-20501)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/admin.cgi|3f|action|3d|"; startswith; fast_pattern; pcre:"/^(?:upgrade|config_(?:save|restore))$/R"; http.request_body; pcre:"/(?:firmware(?:Serverip|Restore)|config(?:Backup|Restore|Serverip)|downloadServerip)[^\x26]*?(?:(?:\x3b|%3[Bb])|(?:\x0a|%0[Aa])|(?:\x60|%60)|(?:\x7c|%7[Cc])|(?:\x24|%24))+/P"; reference:cve,2019-20499; reference:cve,2019-20500; reference:cve,2019-20501; reference:url,unit42.paloaltonetworks.com/mirai-variant-targets-iot-exploits/; reference:url,www.exploit-db.com/exploits/46841; classtype:attempted-admin; sid:2057317; rev:1; metadata:attack_target Networking_Equipment, tls_state plaintext, created_at 2024_11_07, cve CVE_2019_20499, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2024_11_07; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Tenda HG9 Router Command Injection Attempt (CVE-2022-30023)"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:17; content:"/boaform/formPing"; fast_pattern; http.request_body; content:"pingAddr|3d|"; pcre:"/^[^\x26]*?(?:(?:\x3b|%3[Bb])|(?:\x0a|%0[Aa])|(?:\x60|%60)|(?:\x7c|%7[Cc])|(?:\x24|%24))+/R"; reference:cve,2022-30023; reference:url,unit42.paloaltonetworks.com/mirai-variant-targets-iot-exploits/; classtype:attempted-admin; sid:2057319; rev:1; metadata:affected_product Tenda, attack_target Networking_Equipment, tls_state plaintext, created_at 2024_11_07, cve CVE_2022_30023, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2024_11_07, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Axis Communications Security Camera Command Injection Attempt (CVE-2018-10660) M1"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/axis-cgi/"; fast_pattern; startswith; content:".cgi|3f|"; distance:0; pcre:"/^.+(?:(?:\x3b|%3[Bb])|(?:\x0a|%0[Aa])|(?:\x60|%60)|(?:\x7c|%7[Cc])|(?:\x24|%24))+/R"; reference:url,www.vdoo.com/blog/vdoo-discovers-significant-vulnerabilities-in-axis-cameras/; reference:cve,2018-10660; classtype:attempted-admin; sid:2059463; rev:1; metadata:affected_product Axis_Communications, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_01_22, cve CVE_2018_10660, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_01_22, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Axis Communications Security Camera Command Injection Attempt (CVE-2018-10660, CVE-2018-10661, CVE-2018-10662) M2"; flow:established,to_server; http.method; content:"POST"; http.uri; content:".srv"; endswith; http.request_body; content:"com.axis.PolicyKitParhand"; fast_pattern; content:"string:"; distance:0; pcre:"/^[^\x26]*?(?:(?:\x3b|%3[Bb])|(?:\x0a|%0[Aa])|(?:\x60|%60)|(?:\x7c|%7[Cc])|(?:\x24|%24))+/R"; reference:url,www.vdoo.com/blog/vdoo-discovers-significant-vulnerabilities-in-axis-cameras/; reference:cve,2018-10660; reference:cve,2018-10661; reference:cve,2018-10662; reference:url,www.exploit-db.com/exploits/45100; classtype:attempted-admin; sid:2059464; rev:1; metadata:affected_product Axis_Communications, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_01_22, cve CVE_2018_10660_CVE_2018_10661_CVE_2018_10662, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_01_22, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS TP-Link TL-WR940N Hardware v3/v4 Authenticated Remote Code Execution (CVE-2024-54887)"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/userRpm/Wan6to4TunnelCfgRpm.htm?"; fast_pattern; content:"dnsserver"; pcre:"/^[12]\x3d[^\x26]*?\x27\x70\xc0\x01\x2a/R"; reference:url,infosecwriteups.com/reversing-discovering-and-exploiting-a-tp-link-router-vulnerability-cve-2024-54887-341552c4b104; reference:cve,2024-54887; classtype:web-application-attack; sid:2059682; rev:1; metadata:affected_product TPLINK, attack_target Server, tls_state TLSDecrypt, created_at 2025_01_27, cve CVE_2024_54887, deployment Perimeter, deployment Internal, deployment SSLDecrypt, confidence High, signature_severity Major, tag Exploit, updated_at 2025_01_27, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Reolink RLC Series IP Camera TestEmail Authenticated Command Injection Attempt (CVE-2019-11001)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/cgi-bin/api.cgi|3f|cmd|3d|TestEmail"; fast_pattern; startswith; http.request_body; content:"|22|cmd|22|"; content:"|22|TestEmail|22 2c|"; within:20; content:"|22|addr"; distance:0; pcre:"/^[1-3]\x22\x3a[^\x26]*?(?:(?:\x3b|%3[Bb])|(?:\x0a|%0[Aa])|(?:\x60|%60)|(?:\x7c|%7[Cc])|(?:\x24|%24))+/R"; reference:url,github.com/advisories/GHSA-73c7-5g37-cmq7; reference:url,github.com/mcw0/PoC/blob/master/Reolink-IPC-RCE.py; reference:cve,2019-11001; classtype:attempted-admin; sid:2059683; rev:1; metadata:affected_product Reolink, attack_target IoT, tls_state plaintext, created_at 2025_01_27, cve CVE_2019_11001, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, tag CISA_KEV, updated_at 2025_01_27, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Reolink RLC Series IP Camera SetDdns Authenticated Command Injection Attempt (CVE-2021-40407, CVE-2021-40408, CVE-2021-40409)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/cgi-bin/api.cgi|3f|cmd|3d|SetDdns"; fast_pattern; startswith; http.request_body; content:"|22|cmd|22|"; content:"|22|SetDdns|22 2c|"; within:20; pcre:"/^.+\x22(?:domain|password|username)\x22\x3a[^\x26]*?(?:(?:\x3b|%3[Bb])|(?:\x0a|%0[Aa])|(?:\x60|%60)|(?:\x7c|%7[Cc])|(?:\x24|%24))+/Rm"; reference:url,talosintelligence.com/vulnerability_reports/TALOS-2021-1424; reference:cve,2021-40407; reference:cve,2021-40408; reference:cve,2021-40409; classtype:attempted-admin; sid:2059709; rev:1; metadata:affected_product Reolink, attack_target IoT, tls_state plaintext, created_at 2025_01_27, cve CVE_2021_40407_CVE_2021_40408_CVE_2021_40409, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, tag CISA_KEV, updated_at 2025_01_27, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Reolink RLC Series IP Camera SetLocalLink Authenticated Command Injection Attempt (CVE-2021-40410, CVE-2021-40411)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/cgi-bin/api.cgi|3f|cmd|3d|SetLocalLink"; fast_pattern; startswith; http.request_body; content:"|22|cmd|22|"; content:"|22|SetLocalLink|22 2c|"; within:20; content:"|22|dns"; distance:0; pcre:"/^[12]\x22\x3a[^\x26]*?(?:(?:\x3b|%3[Bb])|(?:\x0a|%0[Aa])|(?:\x60|%60)|(?:\x7c|%7[Cc])|(?:\x24|%24))+/R"; reference:url,talosintelligence.com/vulnerability_reports/TALOS-2021-1424; reference:cve,2021-40410; reference:cve,2021-40411; classtype:attempted-admin; sid:2059712; rev:1; metadata:affected_product Reolink, attack_target IoT, tls_state plaintext, created_at 2025_01_27, cve CVE_2021_40410_CVE_2021_40411, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_01_27, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Reolink RLC Series IP Camera SetDevName Authenticated Command Injection Attempt (CVE-2021-40412)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/cgi-bin/api.cgi|3f|cmd|3d|SetDevName"; fast_pattern; startswith; http.request_body; content:"|22|cmd|22|"; content:"|22|SetDevName|22 2c|"; within:20; content:"|22|name|22 3a|"; distance:0; pcre:"/^[^\x26]*?(?:(?:\x3b|%3[Bb])|(?:\x0a|%0[Aa])|(?:\x60|%60)|(?:\x7c|%7[Cc])|(?:\x24|%24))+/R"; reference:url,talosintelligence.com/vulnerability_reports/TALOS-2021-1424; reference:cve,2021-40412; classtype:attempted-admin; sid:2059717; rev:1; metadata:affected_product Reolink, attack_target IoT, created_at 2025_01_27, cve CVE_2021_40412, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_01_27; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Netgear R6850 Command Injection via c4_IPAddr Parameter Attempt (CVE-2024-30568)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/setup.cgi|3f|"; startswith; http.request_body; content:"todo|3d|ping_test"; fast_pattern; content:"c4_IPAddr|3d|"; pcre:"/^.*?(?:(?:\x3b|%3[Bb])|(?:\x0a|%0[Aa])|(?:\x60|%60)|(?:\x7c|%7[Cc])|(?:\x24|%24)|(?:\x26|%26){2})+/R"; content:"next_file|3d|diagping.htm"; reference:cve,2024-30568; reference:url,github.com/projectdiscovery/nuclei-templates/blob/main/http/cves/2024/CVE-2024-30568.yaml; classtype:attempted-admin; sid:2061410; rev:1; metadata:affected_product Netgear_Router, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_04_09, cve CVE_2024_30568, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_04_09, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Totolink A3700R Multiple Authentication Bypass cstecgecgi.cgi Endpoints (CVE-2025-3663 - CVE-2025-3668)"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:20; content:"/cgi-bin/cstecgi.cgi"; fast_pattern; http.header_names; content:!"|0d 0a|cookie|0d 0a|"; nocase; http.request_body; content:"|22|topicurl|22 3a 22|"; pcre:"/^(?:setL2tpServerCfg|setUrlFilterRules|setScheduleCfg|setUPnPCfg|setWiFiEasyGuestCfg|setWiFiEasyCfg|setSmartQosCfg|setDdnsCfg)/R"; reference:cve,2025-3665; reference:cve,2025-3666; reference:url,avender-bicycle-a5a.notion.site/CVE-1ab53a41781f804898a0effa45d0f15d; reference:cve,2025-3664; reference:cve,2025-3668; reference:cve,2025-3667; reference:cve,2025-3663; classtype:web-application-attack; sid:2061620; rev:1; metadata:affected_product TOTOLINK, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_04_16, cve CVE_2025_3663_CVE_2025_3668, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_04_16, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS D-Link DIR-823G Multiple HNAP SOAPAction Endpoints Authentication Bypass (CVE-2025-2359, CVE-2025-2360)"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:7; content:"/HNAP1/"; http.header; content:"SOAPAction|3a 20 22|http|3a 2f 2f|purenetworks.com/HNAP1/Set"; fast_pattern; pcre:"/^(?:DDNSSettings|UpnpSettings)/R"; http.header_names; content:!"|0d 0a|cookie|0d 0a|"; nocase; http.request_body; content:"|3c|Set"; pcre:"/^(?:DDNSSettings|UpnpSettings)\x20/R"; reference:cve,2025-2359; reference:cve,2025-2360; reference:url,lavender-bicycle-a5a.notion.site/CVE-1ab53a41781f804898a0effa45d0f15d; classtype:web-application-attack; sid:2061622; rev:1; metadata:affected_product D_Link, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_04_16, cve CVE_2025_2359_CVE_2025_2360, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_04_16, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS D-Link DIR-823G Multiple HNAP SOAPAction Endpoints Authentication Bypass"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:7; content:"/HNAP1/"; http.header; content:"SOAPAction|3a 20 22|http|3a 2f 2f|purenetworks.com/HNAP1/Get"; fast_pattern; pcre:"/^(?:GuestNetworkSettings|LocalMacAddress|RouterInformationSettings|RouterLanSettings)/R"; http.header_names; content:!"|0d 0a|cookie|0d 0a|"; nocase; http.request_body; content:"|3c|Get"; pcre:"/^(?:GuestNetworkSettings|LocalMacAddress|RouterInformationSettings|RouterLanSettings)\x20/R"; reference:url,lavender-bicycle-a5a.notion.site/CVE-1ab53a41781f804898a0effa45d0f15d; classtype:web-application-attack; sid:2061623; rev:1; metadata:affected_product D_Link, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_04_16, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_04_16, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Totolink BufferOverflow Attempt formWsc localPin Parameter Buffer Overflow Attempt"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:15; content:"/boafrm/formWsc"; fast_pattern; http.request_body; content:"localPin"; pcre:"/^\x3d[^\x26$]{100,}(?:\x26|$)/R"; http.header_names; content:!"|0d 0a|Cookie|0d 0a|"; reference:url,github.com/fizz-is-on-the-way/Iot_vuls/tree/main/N150RT; classtype:web-application-attack; sid:2062175; rev:1; metadata:affected_product TOTOLINK, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_05_08, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_05_08, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Totolink BufferOverflow Attempt formRoute metric Parameter Denial of Service Attempt"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:17; content:"/boafrm/formRoute"; fast_pattern; http.request_body; content:"metric"; pcre:"/^\x3d[^\x26$]{100,}(?:\x26|$)/R"; http.header_names; content:!"|0d 0a|Cookie|0d 0a|"; reference:cve,2025-3994; reference:url,github.com/fizz-is-on-the-way/Iot_vuls/tree/main/N150RT; classtype:web-application-attack; sid:2062176; rev:1; metadata:affected_product TOTOLINK, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_05_08, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_05_08, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Totolink BufferOverflow Attempt formWsc localPin Command Injection Attempt (CVE-2025-3987)"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:15; content:"/boafrm/formWsc"; fast_pattern; http.request_body; content:"localPin|3d|"; pcre:"/^.*?(?:(?:\x3b|%3[Bb])|(?:\x0a|%0[Aa])|(?:\x60|%60)|(?:\x7c|%7[Cc])|(?:\x24|%24)|(?:\x26|%26){2})+/R"; http.header_names; content:!"|0d 0a|Cookie|0d 0a|"; reference:cve,2025-3987; reference:url,github.com/fizz-is-on-the-way/Iot_vuls/tree/main/N150RT; classtype:attempted-admin; sid:2062203; rev:1; metadata:affected_product TOTOLINK, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_05_08, cve CVE_2025_3987, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_05_08, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Totolink BufferOverflow Attempt multiple URI endpoints submit-url Parameter Buffer Overflow Attempt (CVE-2025-3990, CVE-2025-3993)"; flow:established,to_server; http.method; content:"POST"; http.uri; content:"/boafrm/form"; startswith; pcre:"/^(?:Vlan|WdsEncrypt|Wlwds|Wsc)/R"; http.request_body; content:"submit-url"; fast_pattern; pcre:"/^\x3d[^\x26$]{100,}(?:\x26|$)/R"; http.header_names; content:!"|0d 0a|Cookie|0d 0a|"; reference:cve,2025-3990; reference:cve,2025-3991; reference:cve,2025-3992; reference:cve,2025-3993; reference:url,github.com/fizz-is-on-the-way/Iot_vuls/tree/main/N150RT; classtype:web-application-attack; sid:2062172; rev:2; metadata:affected_product TOTOLINK, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_05_08, cve CVE_2025_3990, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_05_08, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Totolink formPortFw service_type Parameter Buffer Overflow Attempt (CVE-2025-3988)"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:18; content:"/boafrm/formPortFw"; fast_pattern; http.request_body; content:"service_type"; pcre:"/^\x3d[^\x26$]{100,}(?:&|$)/R"; http.header_names; content:!"|0d 0a|Cookie|0d 0a|"; reference:cve,2025-3988; reference:url,github.com/fizz-is-on-the-way/Iot_vuls/tree/main/N150RT; reference:cve,2025-5793; classtype:web-application-attack; sid:2062171; rev:2; metadata:affected_product TOTOLINK, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_05_08, cve CVE_2025_3988, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_05_09, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Totolink A3002R formIpv6Setup static_dns1/static_dns2 Parameter Buffer Overflow Attempt (CVE-2025-45867)"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:21; content:"/boafrm/formIpv6Setup"; fast_pattern; http.request_body; content:"submit-url|3d|"; pcre:"/(?:static_dns1|static_dns2)\x3d[^\x26$]{100,}(?:\x26|$)/"; reference:url,github.com/Jiangxiazhe/IOT_hack/blob/main/TOTOLINK/A3002R/10/overflow.md; reference:cve,2025-45867; classtype:web-application-attack; sid:2062302; rev:1; metadata:affected_product TOTOLINK, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_05_13, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_05_13, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Tenda AC10 setPptpUserList list Parameter Buffer Overflow Attempt (CVE-2025-45779)"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:23; content:"/goform/setPptpUserList"; fast_pattern; http.request_body; content:"list|3d|"; pcre:"/^[^\x26&]{200,}(?:\x26|$)/R"; reference:url,github.com/sunyou-iot/iot-vul/tree/main/TendaAC10/CVE-2025-45779; reference:cve,2025-45779; reference:cve,2025-5848; classtype:attempted-admin; sid:2062281; rev:2; metadata:affected_product Tenda, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_05_12, cve CVE_2025_45779, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_05_13; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Totolink A3002R formMapDel devicemac1 Parameter Command Injection Attempt (CVE-2025-45858)"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:18; content:"/boafrm/formMapDel"; fast_pattern; http.request_body; content:"deviceNum|3d|"; content:"enabled1|3d|"; content:"devicemac1|3d|"; pcre:"/^.*?(?:(?:\x3b|%3[Bb])|(?:\x0a|%0[Aa])|(?:\x60|%60)|(?:\x7c|%7[Cc])|(?:\x24|%24)|(?:\x26{2}|%26%26))+/R"; reference:cve,2025-45858; reference:url,github.com/Jiangxiazhe/IOT_hack/blob/main/TOTOLINK/A3002R/2/injection2.md; classtype:attempted-admin; sid:2062309; rev:1; metadata:affected_product TOTOLINK, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_05_13, cve CVE_2025_45858, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_05_13, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Totolink A3002R formDnsv6 routername Parameter Buffer Overflow Attempt"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:17; content:"/boafrm/formDnsv6"; fast_pattern; http.request_body; content:"submit|3d|Save"; content:"enable_dnsv6|3d|1"; content:"routername|3d|"; pcre:"/^[^\x26$]{100,}(?:\x26|$)/R"; reference:url,github.com/Jiangxiazhe/IOT_hack/blob/main/TOTOLINK/A3002R/3/overflow.md; classtype:web-application-attack; sid:2062314; rev:1; metadata:affected_product TOTOLINK, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_05_13, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_05_13, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Totolink A3002R formMapDelDevice bandstr/macstr Parameter Buffer Overflow Attempt (CVE-2025-45859)"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:24; content:"/boafrm/formMapDelDevice"; fast_pattern; http.request_body; content:"clientoff|3d|no"; pcre:"/(?:bandstr|macstr)\x3d[^\x26$]{100,}(?:\x26|$)/R"; reference:url,github.com/Jiangxiazhe/IOT_hack/blob/main/TOTOLINK/A3002R/4/overflow.md; reference:url,github.com/Jiangxiazhe/IOT_hack/blob/main/TOTOLINK/A3002R/5/overflow.md; reference:cve,2025-45859; classtype:web-application-attack; sid:2062316; rev:1; metadata:affected_product TOTOLINK, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_05_13, cve CVE_2025_45859, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_05_13, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Totolink A3002R formDhcpv6s Multiple Parameters Buffer Overflow Attempt (CVE-2025-45864,2025-45866)"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:19; content:"/boafrm/formDhcpv6s"; fast_pattern; http.request_body; content:"wan_enable|3d|1"; content:"enable_dhcpv6s|3d|1"; pcre:"/(?:addrPoolStart|addrPoolEnd|interfacenameds|dnsaddr)\x3d[^\x26$]{100,}(?:\x26|$)/R"; reference:url,github.com/Jiangxiazhe/IOT_hack/blob/main/TOTOLINK/A3002R/6/overflow.md; reference:url,github.com/Jiangxiazhe/IOT_hack/blob/main/TOTOLINK/A3002R/7/overflow.md; reference:url,github.com/Jiangxiazhe/IOT_hack/blob/main/TOTOLINK/A3002R/8/overflow.md; reference:cve,2025-45864; reference:cve,2025-45866; classtype:web-application-attack; sid:2062319; rev:1; metadata:affected_product TOTOLINK, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_05_13, cve CVE_2025_45864, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_05_13, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Netgear R8500 host_check.php hostname Parameter Buffer Overflow Attempt"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:15; content:"/host_check.php"; fast_pattern; http.request_body; content:"hostname|3d|"; pcre:"/^[^\x26$]{100,}(?:\x26|$)/R"; reference:url,github.com/wudipjq/my_vuln/blob/main/Netgear7/vuln_65/65.md; classtype:web-application-attack; sid:2062711; rev:1; metadata:affected_product Netgear_Router, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_06_02, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_06_02, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS Totolink UploadFirmwareFile File Parameter Buffer Overflow Attempt (CVE-2025-5901)"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:20; content:"/cgi-bin/cstecgi.cgi"; http.request_body; content:"|22|UploadFirmwareFile|22|"; fast_pattern; content:"|22|File|22|"; pcre:"/^[^\x2c\x7d$]{100,}(?:\x2c|\x7d|$)/R"; reference:url,candle-throne-f75.notion.site/TOTOLINK-T10-UploadCustomModule-20bdf0aa118580d59961cd545582c118; reference:cve,2025-5901; classtype:web-application-attack; sid:2062872; rev:1; metadata:affected_product TOTOLINK, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_06_10, cve CVE_2025_5901, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, tag AI_Generated_Description, updated_at 2025_06_10, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS D-Link Arbitrary File Read Via webproc errorpage Parameter (CVE-2021-27250)"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:16; content:"/cgi-bin/webproc"; fast_pattern; http.cookie; content:"sys_UserName|3d|admin"; http.request_body; content:"errorpage|3d|"; pcre:"/^(?:\x2f|[^\x26]*?(?:(?:\x2e|%2[Ee]){1,2}(?:\x2f|\x5c|%5[Cc]|%2[Ff]){1,}){2,})/R"; reference:cve,2021-27250; reference:url,github.com/PeiQi0/PeiQi-WIKI-Book/tree/main/docs/wiki/iot; classtype:attempted-admin; sid:2063272; rev:1; metadata:affected_product D_Link, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_07_02, cve CVE_2021_27250, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_07_02, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS D-Link importhtml sql Parameter SQL Injection Attempt"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/importhtml.php|3f|"; fast_pattern; startswith; content:"sql|3d|c2VsZWN0"; reference:url,github.com/PeiQi0/PeiQi-WIKI-Book/tree/main/docs/wiki/iot; classtype:web-application-attack; sid:2063277; rev:1; metadata:affected_product D_Link, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_07_02, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, tag Description_Generated_By_Proofpoint_Nexus, updated_at 2025_07_02, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS D-Link getcfg Information Disclosure Attempt (CVE-2019-17506)"; flow:established,to_server; http.request_line; content:"GET /getcfg.php?"; startswith; http.request_body; content:"SERVICES|3d|DEVICE.ACCOUNT"; startswith; fast_pattern; content:"|25|0AAUTHORIZED_GROUP"; pcre:"/^(?:\x3d|\x253[Dd])1/R"; reference:cve,2019-17506; reference:url,github.com/PeiQi0/PeiQi-WIKI-Book/tree/main/docs/wiki/iot; classtype:attempted-admin; sid:2063278; rev:1; metadata:affected_product D_Link, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_07_02, cve CVE_2019_17506, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_07_02, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS HikVision triggerSnapshot fileUrl Parameter Arbitrary File Download Attempt"; flow:established,to_server; http.method; content:"GET"; http.uri; content:"/eps/api/triggerSnapshot/download|3f|"; fast_pattern; startswith; content:"token|3d|"; content:"fileUrl|3d|file|3a 2f 2f|"; content:"filename|3d|"; reference:url,github.com/PeiQi0/PeiQi-WIKI-Book/tree/main/docs/wiki/iot; classtype:attempted-admin; sid:2063283; rev:1; metadata:affected_product HikVision, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_07_03, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_07_03, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-web_specific_apps.rules
alert http any any -> $HOME_NET any (msg:"ET WEB_SPECIFIC_APPS HikVision upload.action JSP Webshell Upload Attempt"; flow:established,to_server; http.method; content:"POST"; http.uri; bsize:37; content:"/eps/resourceOperations/upload.action"; fast_pattern; http.request_body; content:"Content-Disposition|3a 20|form-data|3b 20|name|3d 22|fileUploader|22 3b|"; content:"filename|3d 22|"; within:20; content:".jsp|22|"; within:50; content:"Content-Type|3a 20|"; within:40; content:"|3c 25|"; within:20; reference:url,github.com/PeiQi0/PeiQi-WIKI-Book/tree/main/docs/wiki/iot; classtype:attempted-admin; sid:2063296; rev:1; metadata:affected_product HikVision, attack_target Networking_Equipment, tls_state plaintext, created_at 2025_07_03, deployment Perimeter, deployment Internal, performance_impact Low, confidence High, signature_severity Major, tag Exploit, updated_at 2025_07_03, mitre_tactic_id TA0001, mitre_tactic_name Initial_Access, mitre_technique_id T1190, mitre_technique_name Exploit_Public_Facing_Application; target:dest_ip;)

# source: PublicRules/et_rules/emerging-worm.rules
alert http any any -> $HOME_NET 8080 (msg:"ET WORM TheMoon.linksys.router 2"; flow:to_server,established; http.method; content:"POST"; http.uri; content:"/tmUnblock.cgi"; reference:url,isc.sans.edu/forums/diary/Linksys+Worm+Captured/17630; reference:url,devttys0.com/2014/02/wrt120n-fprintf-stack-overflow/; classtype:trojan-activity; sid:2018132; rev:5; metadata:created_at 2014_02_13, signature_severity Major, updated_at 2020_07_07;)

# source: PublicRules/et_rules/emerging-worm.rules
alert http any any -> $HOME_NET 8080 (msg:"ET WORM TheMoon.linksys.router 3"; flow:to_server,established; http.method; content:"POST"; http.uri; content:"/hndUnblock.cgi"; reference:url,isc.sans.edu/forums/diary/Linksys+Worm+Captured/17630; reference:url,exploit-db.com/exploits/31683/; reference:url,devttys0.com/2014/02/wrt120n-fprintf-stack-overflow/; classtype:trojan-activity; sid:2018155; rev:5; metadata:created_at 2014_02_19, signature_severity Major, updated_at 2020_07_07;)

# source: PublicRules/et_rules/emerging-worm.rules
alert http any any -> $HOME_NET 8080 (msg:"ET WORM TheMoon.linksys.router 1"; flow:established; urilen:7; http.method; content:"GET"; http.uri; content:"/HNAP1/"; http.host; pcre:"/^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$/"; reference:url,isc.sans.edu/forums/diary/Linksys+Worm+Captured/17630; classtype:trojan-activity; sid:2018131; rev:6; metadata:created_at 2014_02_13, signature_severity Major, updated_at 2020_08_18;)

